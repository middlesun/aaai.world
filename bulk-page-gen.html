<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bulk Page Generator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&family=Inter:wght@400;500;600&family=Roboto+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --aurora-cyan: #74f9ff;
            --aurora-purple: #b86adf;
            --aurora-pink: #ff9a8b;
            --glass-bg: rgba(255, 255, 255, 0.10);
            --glass-border: rgba(255, 255, 255, 0.18);
            --glass-shadow: rgba(0, 0, 0, 0.25);
            --text-primary: rgba(255, 255, 255, 0.95);
            --text-secondary: rgba(255, 255, 255, 0.75);
            --text-muted: rgba(255, 255, 255, 0.55);
        }

        * {
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            font-size: 15px;
            line-height: 24px;
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #0c0c0c 0%, #1a1a2e 50%, #16213e 100%);
            position: relative;
            overflow-x: hidden;
        }

        /* Aurora Background Animation */
        body::before {
            content: '';
            position: fixed;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, var(--aurora-cyan), var(--aurora-purple), var(--aurora-pink), var(--aurora-cyan));
            background-size: 400% 400%;
            animation: aurora 8s ease-in-out infinite;
            opacity: 0.15;
            z-index: -1;
        }

        @keyframes aurora {
            0%, 100% { background-position: 0% 50%; }
            25% { background-position: 100% 50%; }
            50% { background-position: 100% 100%; }
            75% { background-position: 0% 100%; }
        }

        /* Typography */
        h1, h2, h3, h4, h5, h6 {
            font-family: 'Poppins', sans-serif;
            font-weight: 600;
            color: var(--text-primary);
        }

        .heading-lg { font-size: 36px; line-height: 44px; }
        .heading-md { font-size: 28px; line-height: 36px; }
        .heading-sm { font-size: 20px; line-height: 28px; }

        .mono { 
            font-family: 'Roboto Mono', monospace; 
            font-weight: 400;
        }

        /* Glass Components */
        .glass-card {
            background: var(--glass-bg);
            backdrop-filter: blur(16px);
            border: 1px solid var(--glass-border);
            border-radius: 18px;
            box-shadow: 0 24px 48px -12px var(--glass-shadow);
            transition: all 300ms cubic-bezier(0.16, 1, 0.3, 1);
            position: relative;
            overflow: hidden;
        }

        .glass-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, var(--glass-border), transparent);
            opacity: 0.8;
        }

        .glass-card:hover {
            transform: scale(1.02);
            box-shadow: 0 32px 64px -12px var(--glass-shadow);
        }

        .glass-card:hover::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            animation: glare 0.6s ease-out;
        }

        @keyframes glare {
            to { left: 100%; }
        }

        /* Form Controls with Aurora Glass */
        .aurora-input {
            background: var(--glass-bg);
            backdrop-filter: blur(16px);
            border: 1px solid var(--glass-border);
            border-radius: 12px;
            padding: 12px 16px;
            color: var(--text-primary);
            font-size: 15px;
            transition: all 300ms cubic-bezier(0.16, 1, 0.3, 1);
            outline: none;
        }

        .aurora-input::placeholder {
            color: var(--text-muted);
        }

        .aurora-input:focus {
            border-color: var(--aurora-cyan);
            box-shadow: 0 0 0 3px rgba(116, 249, 255, 0.2);
            transform: translateY(-1px);
        }

        .aurora-select {
            background: var(--glass-bg);
            backdrop-filter: blur(16px);
            border: 1px solid var(--glass-border);
            border-radius: 12px;
            padding: 12px 16px;
            color: var(--text-primary);
            font-size: 15px;
            transition: all 300ms cubic-bezier(0.16, 1, 0.3, 1);
            outline: none;
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%2374f9ff' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='m6 8 4 4 4-4'/%3e%3c/svg%3e");
            background-position: right 12px center;
            background-repeat: no-repeat;
            background-size: 16px;
            appearance: none;
        }

        .aurora-select:focus {
            border-color: var(--aurora-cyan);
            box-shadow: 0 0 0 3px rgba(116, 249, 255, 0.2);
            transform: translateY(-1px);
        }

        .aurora-select option {
            background: #1a1a2e;
            color: var(--text-primary);
        }

        /* Aurora Button */
        .aurora-button {
            background: linear-gradient(135deg, var(--aurora-cyan), var(--aurora-purple));
            border: none;
            border-radius: 14px;
            padding: 14px 24px;
            color: #000;
            font-weight: 600;
            font-size: 15px;
            transition: all 300ms cubic-bezier(0.16, 1, 0.3, 1);
            position: relative;
            overflow: hidden;
            box-shadow: 0 8px 24px rgba(116, 249, 255, 0.3);
        }

        .aurora-button:hover {
            transform: translateY(-2px) scale(1.02);
            box-shadow: 0 12px 32px rgba(116, 249, 255, 0.4);
        }

        .aurora-button:active {
            transform: translateY(0) scale(0.98);
        }

        .aurora-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .aurora-button.generating {
            animation: buttonPulse 2s ease-in-out infinite;
        }

        @keyframes buttonPulse {
            0%, 100% { 
                box-shadow: 0 8px 24px rgba(116, 249, 255, 0.3);
            }
            50% { 
                box-shadow: 0 12px 32px rgba(116, 249, 255, 0.6);
            }
        }

        /* Glass Secondary Button */
        .glass-button {
            background: var(--glass-bg);
            backdrop-filter: blur(16px);
            border: 1px solid var(--glass-border);
            border-radius: 12px;
            padding: 10px 16px;
            color: var(--text-primary);
            font-weight: 500;
            font-size: 14px;
            transition: all 300ms cubic-bezier(0.16, 1, 0.3, 1);
        }

        .glass-button:hover {
            background: rgba(255, 255, 255, 0.15);
            transform: translateY(-1px);
        }

        /* Active button states */
        .glass-button.active {
            background: linear-gradient(135deg, var(--aurora-cyan), var(--aurora-purple));
            color: #000;
            font-weight: 600;
            box-shadow: 0 4px 16px rgba(116, 249, 255, 0.3);
        }

        .glass-button.active:hover {
            background: linear-gradient(135deg, var(--aurora-cyan), var(--aurora-purple));
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(116, 249, 255, 0.4);
        }

        /* Draggable Creativity Slider */
        .creativity-slider-container {
            padding: 12px 0;
        }

        .creativity-slider-track {
            position: relative;
            height: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
            margin: 16px 0;
            cursor: pointer;
        }

        .creativity-slider-fill {
            position: absolute;
            top: 0;
            left: 0;
            height: 100%;
            background: linear-gradient(90deg, var(--aurora-cyan), var(--aurora-purple));
            border-radius: 3px;
            width: 10%;
            transition: width 300ms cubic-bezier(0.16, 1, 0.3, 1);
            box-shadow: 0 0 12px rgba(116, 249, 255, 0.4);
        }

        .creativity-slider-thumb {
            position: absolute;
            top: 50%;
            left: 0%;
            width: 24px;
            height: 24px;
            background: linear-gradient(135deg, var(--aurora-cyan), var(--aurora-purple));
            border: 3px solid rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            cursor: grab;
            transition: all 300ms cubic-bezier(0.16, 1, 0.3, 1);
            box-shadow: 0 4px 16px rgba(116, 249, 255, 0.3);
            z-index: 3;
        }

        .creativity-slider-thumb:hover {
            transform: translate(-50%, -50%) scale(1.1);
            box-shadow: 0 6px 20px rgba(116, 249, 255, 0.5);
            border-color: rgba(255, 255, 255, 0.4);
        }

        .creativity-slider-thumb:active,
        .creativity-slider-thumb.dragging {
            cursor: grabbing;
            transform: translate(-50%, -50%) scale(1.15);
            box-shadow: 0 8px 24px rgba(116, 249, 255, 0.6);
        }

        .creativity-markers {
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 2px;
            transform: translateY(-50%);
            pointer-events: none;
        }

        .creativity-marker {
            position: absolute;
            width: 2px;
            height: 8px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 1px;
            top: 50%;
            transform: translate(-50%, -50%);
            transition: all 200ms ease;
        }

        .creativity-marker[data-value="1"] { left: 0%; }
        .creativity-marker[data-value="2"] { left: 11.11%; }
        .creativity-marker[data-value="3"] { left: 22.22%; }
        .creativity-marker[data-value="4"] { left: 33.33%; }
        .creativity-marker[data-value="5"] { left: 44.44%; }
        .creativity-marker[data-value="6"] { left: 55.55%; }
        .creativity-marker[data-value="7"] { left: 66.66%; }
        .creativity-marker[data-value="8"] { left: 77.77%; }
        .creativity-marker[data-value="9"] { left: 88.88%; }
        .creativity-marker[data-value="10"] { left: 100%; }

        .creativity-marker.active {
            background: var(--aurora-cyan);
            height: 12px;
            box-shadow: 0 0 8px rgba(116, 249, 255, 0.6);
        }

        /* Aurora Radio Buttons */
        .radio-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .radio-option {
            display: flex;
            align-items: center;
        }

        .aurora-radio {
            display: none;
        }

        .radio-label {
            display: flex;
            align-items: center;
            gap: 12px;
            cursor: pointer;
            padding: 8px 12px;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--glass-border);
            transition: all 300ms cubic-bezier(0.16, 1, 0.3, 1);
            color: var(--text-secondary);
            font-size: 14px;
            font-weight: 500;
            width: 100%;
        }

        .radio-label:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: var(--aurora-cyan);
            transform: translateY(-1px);
        }

        .radio-indicator {
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: var(--glass-bg);
            border: 2px solid var(--glass-border);
            position: relative;
            transition: all 300ms cubic-bezier(0.16, 1, 0.3, 1);
            flex-shrink: 0;
        }

        .aurora-radio:checked + .radio-label {
            background: rgba(116, 249, 255, 0.1);
            border-color: var(--aurora-cyan);
            color: var(--text-primary);
        }

        .aurora-radio:checked + .radio-label .radio-indicator {
            background: linear-gradient(135deg, var(--aurora-cyan), var(--aurora-purple));
            border-color: var(--aurora-cyan);
            box-shadow: 0 0 0 3px rgba(116, 249, 255, 0.2);
        }

        .aurora-radio:checked + .radio-label .radio-indicator::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 6px;
            height: 6px;
            background: #000;
            border-radius: 50%;
            transform: translate(-50%, -50%);
        }

        /* Aurora Checkbox */
        .aurora-checkbox {
            width: 20px;
            height: 20px;
            appearance: none;
            background: var(--glass-bg);
            backdrop-filter: blur(16px);
            border: 1px solid var(--glass-border);
            border-radius: 6px;
            position: relative;
            cursor: pointer;
            transition: all 300ms cubic-bezier(0.16, 1, 0.3, 1);
        }

        .aurora-checkbox:checked {
            background: linear-gradient(135deg, var(--aurora-cyan), var(--aurora-purple));
            border-color: var(--aurora-cyan);
        }

        .aurora-checkbox:checked::after {
            content: '✓';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #000;
            font-size: 12px;
            font-weight: bold;
        }

        /* Aurora Radio Button */
        .aurora-checkbox[type="radio"] {
            border-radius: 50%;
        }

        .aurora-checkbox[type="radio"]:checked::after {
            content: '●';
            font-size: 10px;
        }

        /* Layout Containers */
        .sidebar {
            transition: width 300ms cubic-bezier(0.16, 1, 0.3, 1);
            width: 25%;
            min-width: 400px;
            background: rgba(12, 12, 12, 0.4);
            backdrop-filter: blur(20px);
            border-right: 1px solid var(--glass-border);
            position: relative;
        }

        .sidebar::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(180deg, rgba(116, 249, 255, 0.05) 0%, rgba(184, 106, 223, 0.05) 50%, rgba(255, 154, 139, 0.05) 100%);
            pointer-events: none;
        }

        .sidebar.collapsed {
            width: 80px;
        }

        .sidebar.collapsed .sidebar-content {
            opacity: 0;
            pointer-events: none;
        }

        .sidebar-content {
            transition: opacity 300ms cubic-bezier(0.16, 1, 0.3, 1);
            position: relative;
            z-index: 2;
        }

        .main-content {
            transition: width 300ms cubic-bezier(0.16, 1, 0.3, 1);
            width: 75%;
            background: rgba(12, 12, 12, 0.2);
        }

        .main-content.expanded {
            width: calc(100% - 80px);
        }

        /* Design Grid */
        .design-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            padding: 20px;
            grid-auto-rows: minmax(300px, auto);
        }

        .design-card {
            background: var(--glass-bg);
            backdrop-filter: blur(16px);
            border: 1px solid var(--glass-border);
            border-radius: 18px;
            overflow: hidden;
            transition: all 300ms cubic-bezier(0.16, 1, 0.3, 1);
            box-shadow: 0 16px 32px -8px var(--glass-shadow);
            aspect-ratio: 1;
            display: flex;
            flex-direction: column;
            min-height: 300px;
        }

        .design-card:hover {
            transform: translateY(-2px) scale(1.01);
            box-shadow: 0 20px 40px -8px var(--glass-shadow);
        }

        .design-card.generating {
            animation: subtleGenerate 3s ease-in-out infinite;
            border-color: rgba(116, 249, 255, 0.3);
            box-shadow: 0 16px 32px -8px var(--glass-shadow), 0 0 0 1px rgba(116, 249, 255, 0.2);
        }

        @keyframes subtleGenerate {
            0%, 100% { 
                transform: translateY(0px) scale(1);
                box-shadow: 0 16px 32px -8px var(--glass-shadow), 0 0 0 1px rgba(116, 249, 255, 0.2);
            }
            50% { 
                transform: translateY(-1px) scale(1.005);
                box-shadow: 0 18px 36px -8px var(--glass-shadow), 0 0 0 1px rgba(116, 249, 255, 0.3);
            }
        }

        .design-card-header {
            padding: 12px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            background: rgba(255, 255, 255, 0.05);
            flex-shrink: 0;
        }

        .preview-frame {
            flex: 1;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 12px;
            margin: 8px;
            overflow: hidden;
            min-height: 0;
        }

        /* Progress Elements */
        .aurora-progress {
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
            backdrop-filter: blur(8px);
        }

        .aurora-progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--aurora-cyan), var(--aurora-purple));
            border-radius: 4px;
            transition: width 300ms cubic-bezier(0.16, 1, 0.3, 1);
            box-shadow: 0 0 16px rgba(116, 249, 255, 0.5);
        }

        /* File Dropzone */
        .aurora-dropzone {
            border: 2px dashed var(--glass-border);
            border-radius: 18px;
            background: var(--glass-bg);
            backdrop-filter: blur(16px);
            transition: all 300ms cubic-bezier(0.16, 1, 0.3, 1);
            position: relative;
            overflow: hidden;
        }

        .aurora-dropzone.active {
            border-color: var(--aurora-cyan);
            background: rgba(116, 249, 255, 0.1);
            transform: scale(1.02);
        }

        /* Animations */
        .fade-up {
            animation: fadeUp 300ms cubic-bezier(0.16, 1, 0.3, 1);
        }

        @keyframes fadeUp {
            from {
                opacity: 0;
                transform: translateY(24px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Icons with Aurora blend */
        .aurora-icon {
            mix-blend-mode: screen;
            filter: drop-shadow(0 0 8px rgba(116, 249, 255, 0.3));
        }

        /* Scrollbar */
        .sidebar-content::-webkit-scrollbar {
            width: 6px;
        }

        .sidebar-content::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 3px;
        }

        .sidebar-content::-webkit-scrollbar-thumb {
            background: linear-gradient(180deg, var(--aurora-cyan), var(--aurora-purple));
            border-radius: 3px;
        }

        /* Label styling */
        .aurora-label {
            color: var(--text-secondary);
            font-weight: 500;
            font-size: 14px;
            margin-bottom: 8px;
            display: block;
        }

        /* Status text colors */
        .status-generating { color: var(--aurora-cyan); }
        .status-complete { color: #4ade80; }
        .status-error { color: var(--aurora-pink); }
        .status-paused { color: #fbbf24; }

        /* Toggle button */
        .aurora-toggle {
            background: var(--glass-bg);
            backdrop-filter: blur(16px);
            border: 1px solid var(--glass-border);
            border-radius: 12px;
            padding: 8px;
            color: var(--text-secondary);
            transition: all 300ms cubic-bezier(0.16, 1, 0.3, 1);
        }

        .aurora-toggle:hover {
            background: rgba(255, 255, 255, 0.15);
            color: var(--text-primary);
            transform: scale(1.05);
        }

        .aurora-toggle.rotated {
            transform: rotate(180deg) scale(1.05);
        }

        /* Empty state */
        .empty-state {
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: calc(100vh - 120px);
            text-align: center;
            padding: 48px;
            overflow: hidden;
        }

        .welcome-content {
            position: relative;
            z-index: 10;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .empty-state-icon {
            width: 120px;
            height: 120px;
            background: var(--glass-bg);
            backdrop-filter: blur(16px);
            border-radius: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 24px;
            border: 1px solid var(--glass-border);
        }

        /* Floating Browsers */
        .floating-browsers-container {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            grid-template-rows: repeat(3, 1fr);
            gap: 30px;
            padding: 40px;
            opacity: 0.2;
            z-index: 1;
        }

        .floating-browser {
            background: var(--glass-bg);
            backdrop-filter: blur(16px);
            border: 1px solid var(--glass-border);
            border-radius: 12px;
            overflow: hidden;
            animation: floatBrowser 6s ease-in-out infinite;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            transition: all 300ms ease;
        }

        .floating-browser:nth-child(1) { animation-delay: 0s; }
        .floating-browser:nth-child(2) { animation-delay: -1s; }
        .floating-browser:nth-child(3) { animation-delay: -2s; }
        .floating-browser:nth-child(4) { animation-delay: -3s; }
        .floating-browser:nth-child(5) { animation-delay: -4s; }
        .floating-browser:nth-child(6) { animation-delay: -5s; }

        @keyframes floatBrowser {
            0%, 100% { 
                transform: translateY(0px) rotate(0deg) scale(1);
                opacity: 0.2;
            }
            25% { 
                transform: translateY(-3px) rotate(0.3deg) scale(1.005);
                opacity: 0.25;
            }
            50% { 
                transform: translateY(-2px) rotate(-0.2deg) scale(1.003);
                opacity: 0.22;
            }
            75% { 
                transform: translateY(-4px) rotate(0.2deg) scale(1.007);
                opacity: 0.27;
            }
        }

        .browser-header {
            height: 32px;
            background: rgba(255, 255, 255, 0.05);
            border-bottom: 1px solid var(--glass-border);
            display: flex;
            align-items: center;
            padding: 0 12px;
            gap: 8px;
        }

        .browser-dots {
            display: flex;
            gap: 6px;
        }

        .dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            opacity: 0.7;
        }

        .dot.red { background: #ff5f57; }
        .dot.yellow { background: #ffbd2e; }
        .dot.green { background: #28ca42; }

        .browser-url {
            flex: 1;
            height: 16px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            animation: urlPulse 3s ease-in-out infinite;
        }

        @keyframes urlPulse {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 0.6; }
        }

        .browser-content {
            padding: 16px;
            height: 120px;
        }

        .content-lines {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .line {
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            animation: linePulse 4s ease-in-out infinite;
        }

        .line.header {
            height: 12px;
            width: 70%;
            background: linear-gradient(90deg, var(--aurora-cyan), var(--aurora-purple));
            opacity: 0.4;
        }

        .line.short { width: 40%; }
        .line.medium { width: 65%; }

        @keyframes linePulse {
            0%, 100% { 
                opacity: 0.2;
                transform: scaleX(1);
            }
            50% { 
                opacity: 0.4;
                transform: scaleX(1.02);
            }
        }

        .line:nth-child(1) { animation-delay: 0s; }
        .line:nth-child(2) { animation-delay: 0.5s; }
        .line:nth-child(3) { animation-delay: 1s; }
        .line:nth-child(4) { animation-delay: 1.5s; }
        .line:nth-child(5) { animation-delay: 2s; }

        /* Generation State Animations */
        .floating-browsers-container.generating {
            opacity: 0.6;
        }

        .floating-browsers-container.generating .floating-browser {
            animation: generatingBrowser 2s ease-in-out infinite;
        }

        @keyframes generatingBrowser {
            0%, 100% { 
                transform: translateY(0px) scale(1);
                box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            }
            50% { 
                transform: translateY(-8px) scale(1.05);
                box-shadow: 0 16px 48px rgba(116, 249, 255, 0.3);
            }
        }

        .floating-browsers-container.generating .line {
            animation: generatingLine 1.5s ease-in-out infinite;
        }

        @keyframes generatingLine {
            0%, 100% { 
                opacity: 0.2;
                background: rgba(255, 255, 255, 0.1);
            }
            50% { 
                opacity: 0.6;
                background: linear-gradient(90deg, var(--aurora-cyan), var(--aurora-purple));
            }
        }

        .floating-browsers-container.generating .browser-url {
            animation: generatingUrl 2s ease-in-out infinite;
        }

                 @keyframes generatingUrl {
             0%, 100% { 
                 opacity: 0.3;
                 background: rgba(255, 255, 255, 0.1);
             }
             50% { 
                 opacity: 0.8;
                 background: linear-gradient(90deg, var(--aurora-cyan), var(--aurora-purple));
             }
         }

         /* Welcome Content Animations */
         .sparkle-icon {
             animation: sparkleRotate 4s ease-in-out infinite;
         }

         @keyframes sparkleRotate {
             0%, 100% { 
                 transform: rotate(0deg) scale(1);
                 filter: drop-shadow(0 0 8px rgba(116, 249, 255, 0.3));
             }
             25% { 
                 transform: rotate(5deg) scale(1.05);
                 filter: drop-shadow(0 0 12px rgba(116, 249, 255, 0.5));
             }
             50% { 
                 transform: rotate(0deg) scale(1.1);
                 filter: drop-shadow(0 0 16px rgba(184, 106, 223, 0.4));
             }
             75% { 
                 transform: rotate(-5deg) scale(1.05);
                 filter: drop-shadow(0 0 12px rgba(255, 154, 139, 0.4));
             }
         }

         .welcome-title {
             animation: titleGlow 3s ease-in-out infinite;
             background: linear-gradient(135deg, var(--aurora-cyan), var(--aurora-purple), var(--aurora-pink));
             background-size: 200% 200%;
             -webkit-background-clip: text;
             -webkit-text-fill-color: transparent;
             background-clip: text;
             animation: titleGlow 3s ease-in-out infinite, gradientShift 4s ease-in-out infinite;
         }

         @keyframes titleGlow {
             0%, 100% { 
                 text-shadow: 0 0 20px rgba(116, 249, 255, 0.3);
                 transform: scale(1);
             }
             50% { 
                 text-shadow: 0 0 30px rgba(184, 106, 223, 0.4);
                 transform: scale(1.02);
             }
         }

         @keyframes gradientShift {
             0%, 100% { background-position: 0% 50%; }
             50% { background-position: 100% 50%; }
         }

         .welcome-subtitle {
             animation: subtitleFade 4s ease-in-out infinite;
         }

         @keyframes subtitleFade {
             0%, 100% { opacity: 0.7; }
             50% { opacity: 0.9; }
         }

         /* Feature List Animations */
         .feature-item {
             opacity: 0;
             transform: translateX(-20px);
             animation: slideInStagger 0.8s ease-out forwards;
             transition: all 300ms cubic-bezier(0.16, 1, 0.3, 1);
         }

         .feature-item:nth-child(1) { animation-delay: 0.1s; }
         .feature-item:nth-child(2) { animation-delay: 0.2s; }
         .feature-item:nth-child(3) { animation-delay: 0.3s; }
         .feature-item:nth-child(4) { animation-delay: 0.4s; }
         .feature-item:nth-child(5) { animation-delay: 0.5s; }
         .feature-item:nth-child(6) { animation-delay: 0.6s; }
         .feature-item:nth-child(7) { animation-delay: 0.7s; }

         @keyframes slideInStagger {
             to {
                 opacity: 1;
                 transform: translateX(0);
             }
         }

         .feature-item:hover {
             transform: translateX(10px) scale(1.05);
             background: rgba(116, 249, 255, 0.1);
             border-radius: 12px;
             padding: 8px 16px;
             margin: -8px -16px;
         }

         .feature-item:hover .feature-icon {
             transform: scale(1.2) rotate(5deg);
             filter: drop-shadow(0 0 12px currentColor);
         }

         .feature-icon {
             transition: all 300ms cubic-bezier(0.16, 1, 0.3, 1);
         }

         /* Enhanced CTA Button */
         .cta-button {
             position: relative;
             overflow: hidden;
             background: linear-gradient(135deg, var(--aurora-cyan), var(--aurora-purple));
             animation: ctaPulse 3s ease-in-out infinite;
             transform: scale(1);
             transition: all 400ms cubic-bezier(0.16, 1, 0.3, 1);
         }

         .cta-button::before {
             content: '';
             position: absolute;
             top: -50%;
             left: -50%;
             width: 200%;
             height: 200%;
             background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.3), transparent);
             transform: translateX(-100%);
             transition: transform 600ms;
         }

         .cta-button:hover::before {
             transform: translateX(100%);
         }

         .cta-button:hover {
             transform: translateY(-4px) scale(1.05);
             box-shadow: 0 20px 40px rgba(116, 249, 255, 0.4);
         }

         @keyframes ctaPulse {
             0%, 100% { 
                 box-shadow: 0 8px 24px rgba(116, 249, 255, 0.3);
             }
             50% { 
                 box-shadow: 0 12px 32px rgba(116, 249, 255, 0.5);
             }
         }

         /* Enhanced Welcome Content */
         .welcome-content-enhanced {
             position: relative;
             z-index: 10;
             padding: 2rem;
             backdrop-filter: blur(20px);
             background: rgba(255, 255, 255, 0.05);
             border-radius: 24px;
             border: 1px solid rgba(255, 255, 255, 0.1);
             box-shadow: 0 24px 48px rgba(0, 0, 0, 0.3);
         }

         /* Floating Elements */
         .floating-element {
             position: absolute;
             pointer-events: none;
             opacity: 0.6;
         }

         .floating-element-1 {
             top: 20%;
             left: 10%;
             animation: float1 6s ease-in-out infinite;
         }

         .floating-element-2 {
             top: 60%;
             right: 15%;
             animation: float2 8s ease-in-out infinite;
         }

         .floating-element-3 {
             bottom: 30%;
             left: 20%;
             animation: float3 10s ease-in-out infinite;
         }

         @keyframes float1 {
             0%, 100% { transform: translate(0, 0) rotate(0deg); }
             50% { transform: translate(20px, -30px) rotate(180deg); }
         }

         @keyframes float2 {
             0%, 100% { transform: translate(0, 0) rotate(0deg); }
             50% { transform: translate(-30px, 20px) rotate(-180deg); }
         }

                   @keyframes float3 {
              0%, 100% { transform: translate(0, 0) rotate(0deg); }
              50% { transform: translate(25px, -20px) rotate(90deg); }
          }

         /* Floating Particles */
         .floating-particles {
             position: absolute;
             top: 0;
             left: 0;
             right: 0;
             bottom: 0;
             pointer-events: none;
             overflow: hidden;
         }

         .particle {
             position: absolute;
             width: 4px;
             height: 4px;
             background: var(--aurora-cyan);
             border-radius: 50%;
             opacity: 0.6;
             animation: floatParticle 8s linear infinite;
         }

         .particle:nth-child(1) {
             left: 20%;
             animation-delay: 0s;
             animation-duration: 8s;
         }

         .particle:nth-child(2) {
             left: 40%;
             animation-delay: -2s;
             animation-duration: 10s;
             background: var(--aurora-purple);
         }

         .particle:nth-child(3) {
             left: 60%;
             animation-delay: -4s;
             animation-duration: 12s;
             background: var(--aurora-pink);
         }

         .particle:nth-child(4) {
             left: 80%;
             animation-delay: -6s;
             animation-duration: 9s;
         }

         .particle:nth-child(5) {
             left: 30%;
             animation-delay: -1s;
             animation-duration: 11s;
             background: var(--aurora-purple);
         }

         @keyframes floatParticle {
             0% {
                 transform: translateY(100vh) translateX(0px) scale(0);
                 opacity: 0;
             }
             10% {
                 opacity: 0.6;
                 transform: translateY(90vh) translateX(10px) scale(1);
             }
             90% {
                 opacity: 0.6;
                 transform: translateY(10vh) translateX(-10px) scale(1);
             }
             100% {
                 transform: translateY(0vh) translateX(0px) scale(0);
                 opacity: 0;
             }
         }

         /* Top Progress Bar */
         #topProgressBar {
             position: relative;
             height: 3px;
             background: rgba(255, 255, 255, 0.1);
             overflow: hidden;
         }

         .top-progress-fill {
             height: 100%;
             width: 0%;
             background: linear-gradient(90deg, var(--aurora-cyan), var(--aurora-purple), var(--aurora-pink));
             background-size: 200% 100%;
             animation: progressShimmer 2s ease-in-out infinite;
             transition: width 300ms cubic-bezier(0.16, 1, 0.3, 1);
         }

         @keyframes progressShimmer {
             0%, 100% { background-position: 200% 0; }
             50% { background-position: -200% 0; }
         }

         /* Fullscreen Design Viewer */
         .fullscreen-viewer {
             position: fixed;
             top: 0;
             left: 0;
             right: 0;
             bottom: 0;
             background: rgba(0, 0, 0, 0.95);
             backdrop-filter: blur(20px);
             z-index: 100;
             display: none;
             animation: fadeIn 300ms ease-out;
         }

         .fullscreen-viewer.active {
             display: flex;
             flex-direction: column;
         }

         .fullscreen-header {
             height: 60px;
             background: var(--glass-bg);
             backdrop-filter: blur(16px);
             border-bottom: 1px solid var(--glass-border);
             display: flex;
             align-items: center;
             justify-content: space-between;
             padding: 0 24px;
         }

         .fullscreen-content {
             flex: 1;
             padding: 24px;
             overflow: hidden;
         }

         .fullscreen-iframe {
             width: 100%;
             height: 100%;
             border: none;
             border-radius: 12px;
             background: white;
             box-shadow: 0 24px 48px rgba(0, 0, 0, 0.3);
         }

         @keyframes fadeIn {
             from { opacity: 0; }
             to { opacity: 1; }
         }

         /* Design Card Enhancements */
         .design-card.generating {
             animation: subtleGenerate 3s ease-in-out infinite;
             border-color: var(--aurora-cyan);
             box-shadow: 0 16px 32px -8px var(--glass-shadow), 0 0 0 1px rgba(116, 249, 255, 0.2);
         }

         @keyframes subtleGenerate {
             0%, 100% { 
                 transform: translateY(0px) scale(1);
                 box-shadow: 0 16px 32px -8px var(--glass-shadow), 0 0 0 1px rgba(116, 249, 255, 0.2);
             }
             50% { 
                 transform: translateY(-2px) scale(1.01);
                 box-shadow: 0 20px 40px -8px var(--glass-shadow), 0 0 0 1px rgba(116, 249, 255, 0.4);
             }
         }

         /* Generation Placeholder Styles */
         .generating-placeholder {
             opacity: 0.8;
         }

         .border-aurora-cyan {
             border-color: var(--aurora-cyan);
         }

         .border-t-transparent {
             border-top-color: transparent;
         }

         .from-aurora-cyan\/10 {
             --tw-gradient-from: rgba(116, 249, 255, 0.1);
         }

         .to-aurora-purple\/10 {
             --tw-gradient-to: rgba(184, 106, 223, 0.1);
         }

        /* 8pt grid system */
        .space-1 { margin: 8px; }
        .space-2 { margin: 16px; }
        .space-3 { margin: 24px; }
        .space-4 { margin: 32px; }
        .space-5 { margin: 40px; }
        .space-6 { margin: 48px; }

        .p-1 { padding: 8px; }
        .p-2 { padding: 16px; }
        .p-3 { padding: 24px; }
        .p-4 { padding: 32px; }

        /* Bouncing dots animation */
        .bg-aurora-cyan {
            background-color: var(--aurora-cyan);
        }
        
        .bg-aurora-purple {
            background-color: var(--aurora-purple);
        }
        
        .bg-aurora-pink {
            background-color: var(--aurora-pink);
        }

        /* Mobile responsiveness */
        @media (max-width: 1024px) {
            .sidebar { width: 35%; min-width: 350px; }
            .main-content { width: 65%; }
            .main-content.expanded { width: calc(100% - 80px); }
        }

        @media (max-width: 768px) {
            .sidebar {
                width: 100%;
                min-width: 100%;
                position: fixed;
                top: 0;
                left: 0;
                height: 100vh;
                z-index: 40;
                transform: translateX(-100%);
            }
            .sidebar.open { transform: translateX(0); }
            .sidebar.collapsed { transform: translateX(-100%); }
            .main-content { width: 100%; }
            .main-content.expanded { width: 100%; }
            .mobile-overlay {
                position: fixed;
                inset: 0;
                background: rgba(0, 0, 0, 0.6);
                backdrop-filter: blur(8px);
                z-index: 30;
            }
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen font-sans antialiased overflow-hidden">
    <!-- Main Layout Container -->
    <div class="flex h-screen">
        <!-- Mobile Overlay -->
        <div id="mobileOverlay" class="mobile-overlay hidden lg:hidden"></div>
        
        <!-- Left Sidebar (25% width) -->
        <div id="sidebar" class="sidebar flex flex-col overflow-hidden">
            <!-- Sidebar Header -->
            <div class="flex-shrink-0 p-3 border-b border-white border-opacity-20 flex justify-between items-center">
                <div class="sidebar-content">
                    <h1 class="heading-sm text-white">Bulk Page Generator</h1>
                    <p class="text-sm text-white text-opacity-70 mt-1">Generate pages with your CSS/JS</p>
                </div>
                <button id="apiSettingsBtn" class="aurora-toggle rounded-lg transition-colors">
                    <i data-lucide="settings" class="w-5 h-5 aurora-icon"></i>
                </button>
            </div>
            
            <!-- Sidebar Content -->
            <div class="sidebar-content flex-1 overflow-y-auto p-3">
                <!-- Generator Form -->
                <div class="space-y-4 fade-up">
                    <!-- Session Name Section -->
                    <div class="glass-card p-4">
                        <div class="mb-4">
                            <label for="sessionName" class="aurora-label">Session Name (Optional)</label>
                            <input id="sessionName" type="text" class="aurora-input w-full rounded-lg transition" placeholder="Enter a name for this campaign session...">
                            <p class="mt-1 text-xs text-white text-opacity-60">Used for organizing and exporting your campaign data</p>
                        </div>

                        <!-- JSON Import Section -->
                        <div class="mb-4">
                            <label class="aurora-label">Import Campaign JSON</label>
                            <div id="jsonDropzone" class="aurora-dropzone rounded-lg p-4 text-center cursor-pointer transition">
                                <div class="flex flex-col items-center justify-center space-y-2">
                                    <i data-lucide="file-json" class="w-8 h-8 text-white text-opacity-60 aurora-icon"></i>
                                    <p class="text-sm text-white text-opacity-80">
                                        <span class="font-medium" style="color: var(--aurora-cyan)">Click to import</span> or drag and drop
                                    </p>
                                    <p class="text-xs text-white text-opacity-60">JSON files from previous campaigns</p>
                                </div>
                                <input id="jsonFile" type="file" class="hidden" accept=".json">
                            </div>
                        </div>
                    </div>

                    <!-- Main Configuration Section -->
                    <div class="glass-card p-4">
                            <!-- Prompt Section -->
                            <div class="mb-4">
                                <label for="mainPrompt" class="aurora-label">Main Design Prompt</label>
                                <textarea id="mainPrompt" rows="4" class="aurora-input w-full rounded-lg transition" placeholder="Example: 'a landing page for School Sports Day Event'&#10;&#10;For bulk prompts, use either:&#10;&#10;Simple method (one line each):&#10;/// landing page for restaurant&#10;/// portfolio website for photographer&#10;/// e-commerce store for clothing&#10;&#10;Complex method (multi-line prompts):&#10;Create a comprehensive landing page for a luxury restaurant in downtown Manhattan. Include sections for hero with reservation CTA, chef's story, signature dishes showcase, wine pairing recommendations, customer testimonials, location with interactive map, and contact form. Use elegant typography, warm color scheme, and high-end imagery.&#10;&#10;///-----&#10;&#10;Build a modern portfolio website for a wedding photographer specializing in destination weddings. Features needed: gallery with lightbox functionality, pricing packages, client testimonials, about section with personal story, contact form with availability calendar, and blog section. Use romantic color palette, elegant fonts, and showcase emotional storytelling through imagery."></textarea>
                            </div>

                        <!-- Prompt Modifier Section -->
                        <div class="mb-4">
                            <label for="promptModifier" class="aurora-label">Prompt Modifier (Optional)</label>
                            <textarea id="promptModifier" rows="2" class="aurora-input w-full rounded-lg transition" placeholder="Additional requirements or guidance to apply to every prompt...

Examples:
- Make it responsive and mobile-friendly
- Use modern design principles
- Include accessibility features
- Add smooth animations"></textarea>
                        </div>

                        <!-- UI Framework Section -->
                        <div class="mb-4">
                            <label for="uiFramework" class="aurora-label">UI Framework</label>
                            <select id="uiFramework" class="aurora-select w-full rounded-lg transition">
                                <option value="tailwind">Tailwind CSS (Default)</option>
                                <option value="bootstrap">Bootstrap 5</option>
                                <option value="daisyui">DaisyUI + Tailwind</option>
                                <option value="flowbite">Flowbite + Tailwind</option>
                                <option value="preline">Preline UI + Tailwind</option>
                                <option value="shoelace">Shoelace Web Components</option>
                                <option value="uikit">UIkit</option>
                                <option value="metro">Metro UI</option>
                                <option value="bulma">Bulma CSS</option>
                                <option value="foundation">Foundation</option>
                                <option value="semantic">Semantic UI</option>
                                <option value="materialize">Materialize CSS</option>
                                <option value="custom">Custom Framework</option>
                            </select>
                            <p class="mt-1 text-xs text-white text-opacity-60">All generated pages will use this framework for consistent styling</p>
                        </div>

                        <!-- Custom Framework Section (Hidden by default) -->
                        <div id="customFrameworkSection" class="mb-4 hidden">
                            <label for="cssJsFramework" class="aurora-label">Custom CSS/JS Framework</label>
                            <textarea id="cssJsFramework" rows="4" class="aurora-input w-full rounded-lg transition" placeholder="Add your custom CSS/JS framework code here...

Examples:
- Custom CSS/JS links
- CDN links
- Inline styles
- JavaScript libraries"></textarea>
                        </div>

                        <!-- Subtle Divider -->
                        <div class="border-t border-white border-opacity-10 my-4"></div>

                        <!-- Generation Info -->
                        <div class="mb-4">
                            <div class="glass-card p-3 bg-opacity-50">
                                <div class="flex items-center gap-2 mb-2">
                                    <i data-lucide="info" class="w-4 h-4 text-aurora-cyan"></i>
                                    <span class="text-sm font-medium text-white">How it works</span>
                                </div>
                                <ul class="text-xs text-white text-opacity-70 space-y-1">
                                    <li>• Single prompt: Generates one page</li>
                                    <li>• Simple bulk: Use /// at start of each line</li>
                                    <li>• Complex bulk: Use ///----- between prompts</li>
                                    <li>• Prompt modifier applies to all prompts</li>
                                    <li>• Selected UI framework ensures consistent styling</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- Model Selection (Hidden) -->
                    <div class="glass-card p-3 hidden">
                        <label for="aiModel" class="aurora-label">AI Model</label>
                        <select id="aiModel" class="aurora-select w-full rounded-lg transition">
                            <option value="deepseek/deepseek-chat-v3-0324:free">deepseek/deepseek-chat-v3-0324:free (Free)</option>
                            <option value="deepseek/deepseek-chat-v3-0324">deepseek/deepseek-chat-v3-0324 (Paid)</option>
                        </select>
                    </div>

                    <!-- Custom Prompts Toggle -->
                    <div class="glass-card p-3">
                        <label class="aurora-label">I have my own prompts</label>
                        <div class="grid grid-cols-2 gap-2 mt-2 mb-3">
                            <button class="custom-prompts-btn glass-button py-2 px-3 rounded-lg text-sm font-medium transition-all" data-value="yes">
                                Yes
                            </button>
                            <button class="custom-prompts-btn glass-button py-2 px-3 rounded-lg text-sm font-medium transition-all active" data-value="no">
                                No
                            </button>
                        </div>
                        
                        <!-- Custom Prompts Container -->
                        <div id="customPromptsContainer" class="hidden space-y-3">
                            <!-- File Dropzone -->
                            <div>
                                <label class="aurora-label">Upload Prompts File</label>
                                <div id="fileDropzone" class="aurora-dropzone rounded-lg p-4 text-center cursor-pointer transition">
                                    <div class="flex flex-col items-center justify-center space-y-2">
                                        <i data-lucide="upload-cloud" class="w-8 h-8 text-white text-opacity-60 aurora-icon"></i>
                                        <p class="text-sm text-white text-opacity-80">
                                            <span class="font-medium" style="color: var(--aurora-cyan)">Click to upload</span> or drag and drop
                                        </p>
                                        <p class="text-xs text-white text-opacity-60">JSON or TXT files up to 10MB</p>
                                    </div>
                                    <input id="promptsFile" type="file" class="hidden" accept=".json,.txt">
                                </div>
                            </div>

                            <!-- Or Divider -->
                            <div class="relative">
                                <div class="absolute inset-0 flex items-center">
                                    <div class="w-full border-t border-white border-opacity-20"></div>
                                </div>
                                <div class="relative flex justify-center">
                                    <span class="px-3 text-sm text-white text-opacity-70" style="background: rgba(12, 12, 12, 0.4);">OR</span>
                                </div>
                            </div>

                            <!-- Text Area for Prompts -->
                            <div>
                                <label for="customPrompts" class="aurora-label">Paste Prompts</label>
                                <textarea id="customPrompts" rows="6" class="aurora-input w-full rounded-lg transition" placeholder="Enter prompts using either method:&#10;&#10;Simple (one line each):&#10;/// landing page for restaurant&#10;/// portfolio website for photographer&#10;&#10;Complex (multi-line):&#10;Create a comprehensive landing page...&#10;Include sections for hero, about, services...&#10;&#10;///-----&#10;&#10;Build a modern portfolio website...&#10;Features needed: gallery, testimonials..."></textarea>
                            </div>
                        </div>
                    </div>

                    <!-- Generate Button -->
                    <div class="pt-2">
                                            <button id="generateBtn" class="aurora-button w-full py-4 px-6 rounded-lg shadow-lg transition flex items-center justify-center gap-3">
                        <i data-lucide="code" class="w-5 h-5"></i>
                        <span class="font-semibold">Generate Pages</span>
                    </button>
                    </div>
                </div>


            </div>
        </div>

        <!-- Right Main Content (75% width) -->
        <div id="mainContent" class="main-content flex flex-col overflow-hidden">
            <!-- Top Progress Bar -->
            <div id="topProgressBar" class="hidden">
                <div class="top-progress-fill"></div>
            </div>
            
            <!-- Header Bar -->
            <div class="flex-shrink-0 px-6 py-4" style="background: rgba(12, 12, 12, 0.4); backdrop-filter: blur(20px); border-bottom: 1px solid rgba(255, 255, 255, 0.1);">
                <div class="flex justify-between items-center">
                    <!-- Mobile Menu Button -->
                    <button id="mobileMenuBtn" class="lg:hidden aurora-toggle p-2 rounded-lg">
                        <i data-lucide="menu" class="w-5 h-5 aurora-icon"></i>
                    </button>
                    
                    <div class="flex items-center space-x-4">
                        
                        <!-- Progress Tracker (moved from sidebar) -->
                        <div id="headerProgressContainer" class="hidden">
                            <div class="flex items-center space-x-4">
                                <div class="flex items-center space-x-2">
                                    <span class="text-sm text-white text-opacity-80">
                                        <span id="headerCompletedCount" class="font-medium mono" style="color: var(--aurora-cyan)">0</span>/<span id="headerTotalCount" class="font-medium mono" style="color: var(--aurora-cyan)">0</span>
                                    </span>
                                    <span id="headerStatusText" class="text-sm font-medium status-generating">Ready</span>
                                </div>
                                <div class="flex gap-2">
                                    <button id="headerPauseBtn" class="glass-button p-2 rounded transition-colors" title="Pause">
                                        <i data-lucide="pause" class="w-4 h-4 aurora-icon"></i>
                                    </button>
                                    <button id="headerResumeBtn" class="glass-button p-2 rounded transition-colors hidden" title="Resume">
                                        <i data-lucide="play" class="w-4 h-4 aurora-icon"></i>
                                    </button>
                                    <button id="headerStopBtn" class="glass-button p-2 rounded transition-colors hover:bg-red-500 hover:bg-opacity-20" title="Stop">
                                        <i data-lucide="square" class="w-4 h-4 aurora-icon"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <div id="resultsContainer" class="hidden">
                            <div class="flex items-center gap-3">
                                <button id="downloadAllBtn" class="aurora-button flex items-center gap-2 py-2 px-4 rounded-lg">
                                    <i data-lucide="download" class="w-4 h-4"></i>
                                    <span class="font-medium">Download All Pages</span>
                                </button>
                                <button id="exportJsonBtn" class="glass-button flex items-center gap-2 py-2 px-4 rounded-lg">
                                    <i data-lucide="file-json" class="w-4 h-4 aurora-icon"></i>
                                    <span class="font-medium">Export JSON</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Designs Grid Area -->
            <div class="flex-1 overflow-y-auto">
                <div id="designsGrid" class="design-grid"></div>
                
                <!-- Empty State -->
                <div id="emptyState" class="empty-state">
                    <!-- Landing Page Content -->
                    <div class="welcome-content welcome-content-enhanced">
                        <!-- Floating Decorative Elements -->
                        <div class="floating-element floating-element-1">
                            <i data-lucide="zap" class="w-8 h-8" style="color: var(--aurora-cyan)"></i>
                        </div>
                        <div class="floating-element floating-element-2">
                            <i data-lucide="stars" class="w-6 h-6" style="color: var(--aurora-purple)"></i>
                        </div>
                        <div class="floating-element floating-element-3">
                            <i data-lucide="palette" class="w-7 h-7" style="color: var(--aurora-pink)"></i>
                        </div>
                        
                        <div class="empty-state-icon">
                            <i data-lucide="sparkles" class="w-20 h-20 sparkle-icon" style="color: var(--aurora-cyan)"></i>
                        </div>
                        
                        <h1 class="text-4xl md:text-5xl welcome-title mb-6 text-center font-bold leading-tight">
                            Generate Pages with Consistent UI Frameworks
                        </h1>
                        
                        <div class="max-w-4xl mx-auto grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6 mb-8">
                            <div class="feature-item flex items-center gap-4 text-white text-opacity-90 text-lg">
                                <i data-lucide="server-off" class="feature-icon w-6 h-6 flex-shrink-0" style="color: var(--aurora-cyan)"></i>
                                <span class="font-medium">No Server, No Python, No Coding.</span>
                            </div>
                            <div class="feature-item flex items-center gap-4 text-white text-opacity-90 text-lg">
                                <i data-lucide="gift" class="feature-icon w-6 h-6 flex-shrink-0" style="color: var(--aurora-cyan)"></i>
                                <span class="font-medium">100% Free, No Signup Needed</span>
                            </div>
                            <div class="feature-item flex items-center gap-4 text-white text-opacity-90 text-lg">
                                <i data-lucide="code" class="feature-icon w-6 h-6 flex-shrink-0" style="color: var(--aurora-cyan)"></i>
                                <span class="font-medium">Use your own CSS/JS frameworks</span>
                            </div>
                            <div class="feature-item flex items-center gap-4 text-white text-opacity-90 text-lg">
                                <i data-lucide="play" class="feature-icon w-6 h-6 flex-shrink-0" style="color: var(--aurora-cyan)"></i>
                                <span class="font-medium">Works in the background</span>
                            </div>
                            <div class="feature-item flex items-center gap-4 text-white text-opacity-90 text-lg">
                                <i data-lucide="settings-2" class="feature-icon w-6 h-6 flex-shrink-0" style="color: var(--aurora-cyan)"></i>
                                <span class="font-medium">Fully or Semi-automated</span>
                            </div>
                            <div class="feature-item flex items-center gap-4 text-white text-opacity-90 text-lg">
                                <i data-lucide="repeat" class="feature-icon w-6 h-6 flex-shrink-0" style="color: var(--aurora-cyan)"></i>
                                <span class="font-medium">Run multiple campaigns</span>
                            </div>
                            <div class="feature-item flex items-center gap-4 text-white text-opacity-90 text-lg">
                                <i data-lucide="layers" class="feature-icon w-6 h-6 flex-shrink-0" style="color: var(--aurora-cyan)"></i>
                                <span class="font-medium">Bulk generate with consistent styling</span>
                            </div>
                        </div>
                        
                        <p class="text-xl welcome-subtitle text-center mb-8 text-white text-opacity-80 font-medium leading-relaxed">
                            Generate multiple pages using popular UI frameworks. Perfect for consistent styling across projects.
                        </p>
                        
                        <div class="text-center">
                            <button onclick="document.getElementById('mainPrompt').focus()" class="cta-button py-5 px-10 text-xl font-bold rounded-2xl shadow-2xl flex items-center gap-4 mx-auto text-black relative z-10">
                                <i data-lucide="rocket" class="w-7 h-7"></i>
                                <span>Get Started - Enter Your First Prompt</span>
                            </button>
                        </div>
                    </div>
                    
                    <!-- Floating Browser Grid -->
                    <div id="floatingBrowsers" class="floating-browsers-container">
                        <div class="floating-browser" data-delay="0">
                            <div class="browser-header">
                                <div class="browser-dots">
                                    <div class="dot red"></div>
                                    <div class="dot yellow"></div>
                                    <div class="dot green"></div>
                                </div>
                                <div class="browser-url"></div>
                            </div>
                            <div class="browser-content">
                                <div class="content-lines">
                                    <div class="line header"></div>
                                    <div class="line"></div>
                                    <div class="line short"></div>
                                    <div class="line"></div>
                                    <div class="line medium"></div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="floating-browser" data-delay="200">
                            <div class="browser-header">
                                <div class="browser-dots">
                                    <div class="dot red"></div>
                                    <div class="dot yellow"></div>
                                    <div class="dot green"></div>
                                </div>
                                <div class="browser-url"></div>
                            </div>
                            <div class="browser-content">
                                <div class="content-lines">
                                    <div class="line header"></div>
                                    <div class="line medium"></div>
                                    <div class="line"></div>
                                    <div class="line short"></div>
                                    <div class="line"></div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="floating-browser" data-delay="400">
                            <div class="browser-header">
                                <div class="browser-dots">
                                    <div class="dot red"></div>
                                    <div class="dot yellow"></div>
                                    <div class="dot green"></div>
                                </div>
                                <div class="browser-url"></div>
                            </div>
                            <div class="browser-content">
                                <div class="content-lines">
                                    <div class="line header"></div>
                                    <div class="line short"></div>
                                    <div class="line"></div>
                                    <div class="line medium"></div>
                                    <div class="line"></div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="floating-browser" data-delay="600">
                            <div class="browser-header">
                                <div class="browser-dots">
                                    <div class="dot red"></div>
                                    <div class="dot yellow"></div>
                                    <div class="dot green"></div>
                                </div>
                                <div class="browser-url"></div>
                            </div>
                            <div class="browser-content">
                                <div class="content-lines">
                                    <div class="line header"></div>
                                    <div class="line"></div>
                                    <div class="line medium"></div>
                                    <div class="line short"></div>
                                    <div class="line"></div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="floating-browser" data-delay="800">
                            <div class="browser-header">
                                <div class="browser-dots">
                                    <div class="dot red"></div>
                                    <div class="dot yellow"></div>
                                    <div class="dot green"></div>
                                </div>
                                <div class="browser-url"></div>
                            </div>
                            <div class="browser-content">
                                <div class="content-lines">
                                    <div class="line header"></div>
                                    <div class="line medium"></div>
                                    <div class="line short"></div>
                                    <div class="line"></div>
                                    <div class="line"></div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="floating-browser" data-delay="1000">
                            <div class="browser-header">
                                <div class="browser-dots">
                                    <div class="dot red"></div>
                                    <div class="dot yellow"></div>
                                    <div class="dot green"></div>
                                </div>
                                <div class="browser-url"></div>
                            </div>
                            <div class="browser-content">
                                <div class="content-lines">
                                    <div class="line header"></div>
                                    <div class="line short"></div>
                                    <div class="line medium"></div>
                                    <div class="line"></div>
                                    <div class="line short"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Floating Particles -->
                    <div class="floating-particles">
                        <div class="particle"></div>
                        <div class="particle"></div>
                        <div class="particle"></div>
                        <div class="particle"></div>
                        <div class="particle"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Fullscreen Design Viewer -->
    <div id="fullscreenViewer" class="fullscreen-viewer">
        <div class="fullscreen-header">
            <div class="flex items-center gap-4">
                <h3 id="fullscreenTitle" class="text-lg font-semibold text-white">Design Preview</h3>
            </div>
            <button id="minimizeBtn" class="aurora-toggle p-2 rounded-lg">
                <i data-lucide="minimize-2" class="w-5 h-5 aurora-icon"></i>
            </button>
        </div>
        <div class="fullscreen-content">
            <iframe id="fullscreenIframe" class="fullscreen-iframe"></iframe>
        </div>
    </div>

    <!-- API Settings Modal -->
    <div id="apiSettingsModal" class="fixed inset-0 flex items-center justify-center hidden z-50 p-4" style="background: rgba(0, 0, 0, 0.6); backdrop-filter: blur(8px);">
        <div class="glass-card w-full max-w-md max-h-[90vh] overflow-y-auto">
            <div class="px-6 py-4 border-b border-white border-opacity-20 flex justify-between items-center sticky top-0 bg-inherit">
                <h3 class="heading-sm text-white">API Settings</h3>
                <button id="closeModalBtn" class="aurora-toggle p-2 rounded transition-colors">
                    <i data-lucide="x" class="w-5 h-5 aurora-icon"></i>
                </button>
            </div>
            <div class="p-6 space-y-4">
                <!-- API Key Input -->
                <div>
                    <label for="apiKey" class="aurora-label">OpenRouter API Key</label>
                    <div class="relative">
                        <input id="apiKey" type="password" class="aurora-input w-full pr-12">
                        <button id="toggleApiKeyVisibility" class="absolute inset-y-0 right-0 pr-3 flex items-center">
                            <i data-lucide="eye" class="w-5 h-5 text-white text-opacity-60 hover:text-white transition-colors aurora-icon"></i>
                        </button>
                    </div>
                    <p class="mt-2 text-sm text-white text-opacity-60">Get your API key from <a href="https://openrouter.ai/" target="_blank" class="hover:underline" style="color: var(--aurora-cyan)">OpenRouter</a></p>
                </div>

                <!-- Multi Model Checkbox -->
                <div>
                    <label class="flex items-center gap-3 cursor-pointer">
                        <input id="multiModelCheckbox" type="checkbox" class="aurora-checkbox">
                        <span class="aurora-label mb-0">Multi Model</span>
                    </label>
                    <p class="mt-1 text-xs text-white text-opacity-60">Run prompts across multiple models (up to 10)</p>
                </div>

                <!-- Model Selection -->
                <div id="modelSelectionContainer">
                    <label for="modalAiModel" class="aurora-label">AI Model</label>
                    <select id="modalAiModel" class="aurora-select w-full">
                        <!-- DeepSeek Models (Free) -->
                        <optgroup label="DeepSeek (Free)">
                            <option value="deepseek/deepseek-v3-0324:free">DeepSeek V3 0324 (Mar 2025) - 685B params - 164K ctx</option>
                            <option value="deepseek/deepseek-r1-zero:free">DeepSeek R1 Zero (Jan 2025) - 671B params - 164K ctx</option>
                            <option value="deepseek/deepseek-r1-distill-qwen-32b:free">DeepSeek R1 Distill Qwen 32B (Feb 2025) - 32B params - 16K ctx</option>
                            <option value="deepseek/deepseek-r1-distill-qwen-14b:free">DeepSeek R1 Distill Qwen 14B (Feb 2025) - 14B params - 64K ctx</option>
                            <option value="deepseek/deepseek-r1-distill-llama-70b:free">DeepSeek R1 Distill Llama 70B (Feb 2025) - 70B params - 8K ctx</option>
                            <option value="deepseek/deepseek-r1:free">DeepSeek R1 (Jan 2025) - 671B params - 164K ctx</option>
                            <option value="deepseek/deepseek-v3:free">DeepSeek V3 (Dec 2024) - 685B params - 164K ctx</option>
                            <option value="deepseek/deepseek-chat-v3-0324:free" selected>DeepSeek Chat V3 0324 (Mar 2025) - 685B params - 128K ctx</option>
                        </optgroup>
                        
                        <!-- Google Models (Free) -->
                        <optgroup label="Google (Free)">
                            <option value="google/gemini-2.5-pro-exp-03-25:free">Gemini 2.5 Pro Experimental (Mar 2025) - 1M ctx</option>
                            <option value="google/gemma-3-27b-it:free">Gemma 3 27B (Mar 2025) - 27B params - 131K ctx</option>
                            <option value="google/gemini-2.0-flash-exp:free">Gemini 2.0 Flash Experimental (Dec 2024) - 1M ctx</option>
                            <option value="google/learnlm-1.5-pro-experimental">LearnLM 1.5 Pro Experimental (Nov 2024) - 40K ctx</option>
                        </optgroup>
                        
                        <!-- Qwen Models (Free) -->
                        <optgroup label="Qwen (Free)">
                            <option value="qwen/qwen3-30b-a3b:free">Qwen3-30B-A3B (Apr 2025) - 30B params - 128K ctx</option>
                            <option value="qwen/qwen3-235b-a22b:free">Qwen3-235B-A22B (Apr 2025) - 235B params - 128K ctx</option>
                            <option value="qwen/qwen-2.5-coder-32b-instruct:free">Qwen 2.5 Coder 32B Instruct (Nov 2024) - 32B params - 131K ctx</option>
                            <option value="qwen/qwen-2.5-72b-instruct:free">Qwen 2.5 72B Instruct (Sep 2024) - 72B params - 131K ctx</option>
                        </optgroup>
                        
                        <!-- Meta Models (Free) -->
                        <optgroup label="Meta (Free)">
                            <option value="meta-llama/llama-3.2-90b-vision-instruct:free">Llama 3.2 90B Vision Instruct (Sep 2024) - 90B params - 131K ctx</option>
                            <option value="meta-llama/llama-3.2-11b-vision-instruct:free">Llama 3.2 11B Vision Instruct (Sep 2024) - 11B params - 131K ctx</option>
                            <option value="meta-llama/llama-3.2-3b-instruct:free">Llama 3.2 3B Instruct (Sep 2024) - 3B params - 131K ctx</option>
                            <option value="meta-llama/llama-3.2-1b-instruct:free">Llama 3.2 1B Instruct (Sep 2024) - 1B params - 131K ctx</option>
                            <option value="meta-llama/llama-3.1-8b-instruct:free">Llama 3.1 8B Instruct (Jul 2024) - 8B params - 131K ctx</option>
                        </optgroup>
                        
                        <!-- Microsoft Models (Free) -->
                        <optgroup label="Microsoft (Free)">
                            <option value="microsoft/phi-3-mini-128k-instruct:free">Phi-3 Mini 128K Instruct (Apr 2024) - 3.8B params - 128K ctx</option>
                            <option value="microsoft/phi-3-medium-128k-instruct:free">Phi-3 Medium 128K Instruct (Apr 2024) - 14B params - 128K ctx</option>
                        </optgroup>
                        
                        <!-- Mistral Models (Free) -->
                        <optgroup label="Mistral (Free)">
                            <option value="mistralai/mistral-7b-instruct:free">Mistral 7B Instruct v0.1 (Sep 2023) - 7B params - 32K ctx</option>
                            <option value="mistralai/codestral-mamba:free">Codestral Mamba (Jul 2024) - 7B params - 256K ctx</option>
                        </optgroup>
                        
                        <!-- Hugging Face Models (Free) -->
                        <optgroup label="Hugging Face (Free)">
                            <option value="huggingfaceh4/zephyr-7b-beta:free">Zephyr 7B Beta (Oct 2023) - 7B params - 32K ctx</option>
                        </optgroup>
                        
                        <!-- OpenChat Models (Free) -->
                        <optgroup label="OpenChat (Free)">
                            <option value="openchat/openchat-7b:free">OpenChat 7B (Jul 2023) - 7B params - 8K ctx</option>
                        </optgroup>
                        
                        <!-- Gryphe Models (Free) -->
                        <optgroup label="Gryphe (Free)">
                            <option value="gryphe/mythomist-7b:free">MythoMist 7B (Jan 2024) - 7B params - 32K ctx</option>
                        </optgroup>
                        
                        <!-- Undi95 Models (Free) -->
                        <optgroup label="Undi95 (Free)">
                            <option value="undi95/toppy-m-7b:free">Toppy M 7B (Dec 2023) - 7B params - 4K ctx</option>
                        </optgroup>
                    </select>
                </div>

                <!-- Multi Model Selection Container (Hidden by default) -->
                <div id="multiModelContainer" class="hidden">
                    <label class="aurora-label">Select Models (Max 10)</label>
                    <div id="multiModelList" class="space-y-2 max-h-48 overflow-y-auto border border-white border-opacity-20 rounded-lg p-3 bg-black bg-opacity-20">
                        <!-- Model checkboxes will be populated here -->
                    </div>
                    <p class="text-xs text-white text-opacity-60 mt-2">Selected: <span id="selectedModelCount">0</span>/10</p>
                </div>

                <!-- Download Mode -->
                <div>
                    <label for="downloadModeSelect" class="aurora-label">Download Mode</label>
                    <select id="downloadModeSelect" class="aurora-select w-full">
                        <option value="auto">Auto Download</option>
                        <option value="manual">Manual Download</option>
                    </select>
                </div>

                <!-- Download Prompts -->
                <div>
                    <label for="downloadPromptsSelect" class="aurora-label">Download Prompts</label>
                    <select id="downloadPromptsSelect" class="aurora-select w-full">
                        <option value="no">No</option>
                        <option value="yes">Yes</option>
                    </select>
                </div>

                <!-- Save Button -->
                <div class="pt-4">
                    <button id="saveSettingsBtn" class="aurora-button w-full py-3 px-6 rounded-lg flex items-center justify-center gap-3">
                        <i data-lucide="save" class="w-5 h-5"></i>
                        <span class="font-semibold">Save Settings</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Initialize Lucide icons
        lucide.createIcons();

        // Simple debug mode
        let debugMode = false;

        // System Prompts
        const SYSTEM_PROMPT_1 = `You are an expert web design prompt enhancer. Your primary goal is to take user prompts and ENHANCE them into detailed, comprehensive design briefs while preserving the core intent.

🎯 CORE PRINCIPLES:
1. ALWAYS maintain the user's original concept, industry, and purpose
2. ENHANCE the prompt by adding specific details, sections, and functionality
3. Make each variation more detailed and actionable than the original
4. Preserve the target audience and business objectives
5. Add professional design specifications and modern web features

✅ ENHANCEMENT APPROACH:
• Add specific sections (hero, features, testimonials, pricing, contact, etc.)
• Include detailed layout descriptions (navigation style, content organization)
• Specify modern UI components (cards, buttons, forms, interactive elements)
• Add responsive design considerations and accessibility features
• Include color scheme suggestions appropriate to the industry
• Add typography and visual hierarchy details
• Specify calls-to-action and user journey elements
• Include modern web features (animations, hover effects, etc.)

❌ NEVER CHANGE:
• The core business purpose or industry focus
• The target audience or user needs
• Essential requirements mentioned by the user
• The type of website/application specified

🎨 ENHANCEMENT GOAL:
Transform brief user prompts into comprehensive design briefs that give designers everything they need to create professional, modern websites. Each enhanced prompt should be 3-5x more detailed than the original while staying true to the user's vision.`;

        const SYSTEM_PROMPT_2 = `You are a professional Tailwind CSS designer. Create HTML designs that EXACTLY match the prompt requirements while being visually appealing and modern.

📋 TECHNICAL REQUIREMENTS:
- Use only HTML, Tailwind CSS, and minimal JavaScript
- Include Tailwind CSS CDN: https://cdn.tailwindcss.com
- Enclose everything within <html>...</html> tags (no content outside)
- Add appropriate icon libraries if needed (Heroicons, Lucide, Font Awesome)
- Use custom CSS in <style> tags only when Tailwind is insufficient
- Ensure responsive design with mobile-first approach

🎯 DESIGN APPROACH:
- Follow the prompt specifications precisely - this is critical
- Identify the core purpose and target audience from the prompt
- Create layouts that serve the stated business objectives
- Use modern, clean design principles while staying true to requirements
- Ensure excellent user experience and accessibility
- Make it visually appealing while maintaining functional focus

⚠️ IMPORTANT: Accuracy to the prompt requirements is more important than creative interpretation. The design must solve the specific problem or serve the specific purpose mentioned in the prompt.`;

        // DOM Elements
        const apiSettingsBtn = document.getElementById('apiSettingsBtn');
        const apiSettingsModal = document.getElementById('apiSettingsModal');
        const closeModalBtn = document.getElementById('closeModalBtn');
        const saveSettingsBtn = document.getElementById('saveSettingsBtn');
        const generateBtn = document.getElementById('generateBtn');
        const customPromptsToggle = document.getElementById('customPromptsToggle');
        const customPromptsContainer = document.getElementById('customPromptsContainer');
        const progressContainer = document.getElementById('progressContainer');
        const headerProgressContainer = document.getElementById('headerProgressContainer');
        const resultsContainer = document.getElementById('resultsContainer');
        const designsGrid = document.getElementById('designsGrid');
        const completedCount = document.getElementById('completedCount');
        const totalCount = document.getElementById('totalCount');
        const headerCompletedCount = document.getElementById('headerCompletedCount');
        const headerTotalCount = document.getElementById('headerTotalCount');
        const progressFill = document.getElementById('progressFill');
        const statusText = document.getElementById('statusText');
        const headerStatusText = document.getElementById('headerStatusText');
        const pauseBtn = document.getElementById('pauseBtn');
        const resumeBtn = document.getElementById('resumeBtn');
        const stopBtn = document.getElementById('stopBtn');
        const headerPauseBtn = document.getElementById('headerPauseBtn');
        const headerResumeBtn = document.getElementById('headerResumeBtn');
        const headerStopBtn = document.getElementById('headerStopBtn');
        const downloadAllBtn = document.getElementById('downloadAllBtn');
        const exportJsonBtn = document.getElementById('exportJsonBtn');
        const sessionNameInput = document.getElementById('sessionName');
        const apiKeyInput = document.getElementById('apiKey');
        const modalAiModel = document.getElementById('modalAiModel');
        const mainAiModel = document.getElementById('aiModel');
        const fileDropzone = document.getElementById('fileDropzone');
        const promptsFileInput = document.getElementById('promptsFile');
        const toggleApiKeyVisibility = document.getElementById('toggleApiKeyVisibility');
        const mainPrompt = document.getElementById('mainPrompt');
        const promptModifier = document.getElementById('promptModifier');
        const currentPromptDisplay = document.getElementById('currentPromptDisplay');
        const currentPromptText = document.getElementById('currentPromptText');
        const minimizeBtn = document.getElementById('minimizeBtn');
        
        // JSON Import DOM Elements
        const jsonDropzone = document.getElementById('jsonDropzone');
        const jsonFileInput = document.getElementById('jsonFile');
        
        // New DOM Elements for Layout
        const sidebar = document.getElementById('sidebar');
        const mainContent = document.getElementById('mainContent');
        const mobileMenuBtn = document.getElementById('mobileMenuBtn');
        const mobileOverlay = document.getElementById('mobileOverlay');
        const emptyState = document.getElementById('emptyState');

        // Multi-Model DOM Elements
        const multiModelCheckbox = document.getElementById('multiModelCheckbox');
        const modelSelectionContainer = document.getElementById('modelSelectionContainer');
        const multiModelContainer = document.getElementById('multiModelContainer');
        const multiModelList = document.getElementById('multiModelList');
        const selectedModelCount = document.getElementById('selectedModelCount');

        // UI Framework DOM Elements
        const uiFramework = document.getElementById('uiFramework');
        const customFrameworkSection = document.getElementById('customFrameworkSection');
        const cssJsFramework = document.getElementById('cssJsFramework');

        // State variables
        let isGenerating = false;
        let isPaused = false;
        let currentIndex = 0;
        let prompts = [];
        let generatedDesigns = [];
        let apiKeyVisible = false;
        let generationQueue = [];
        let sidebarCollapsed = false;
        let isMultiModel = false;
        let selectedModels = [];

        // Event Listeners
        apiSettingsBtn.addEventListener('click', () => {
            apiSettingsModal.classList.remove('hidden');
        });

        closeModalBtn.addEventListener('click', () => {
            apiSettingsModal.classList.add('hidden');
        });

        saveSettingsBtn.addEventListener('click', saveSettings);
        generateBtn.addEventListener('click', startGeneration);
        if (pauseBtn) pauseBtn.addEventListener('click', pauseGeneration);
        if (resumeBtn) resumeBtn.addEventListener('click', resumeGeneration);
        if (stopBtn) stopBtn.addEventListener('click', stopGeneration);
        if (headerPauseBtn) headerPauseBtn.addEventListener('click', pauseGeneration);
        if (headerResumeBtn) headerResumeBtn.addEventListener('click', resumeGeneration);
        if (headerStopBtn) headerStopBtn.addEventListener('click', stopGeneration);
        downloadAllBtn.addEventListener('click', downloadAllDesigns);
        exportJsonBtn.addEventListener('click', exportCampaignJson);
        toggleApiKeyVisibility.addEventListener('click', toggleApiKeyVisibilityHandler);
        minimizeBtn.addEventListener('click', closeFullscreenViewer);

        // New Event Listeners for Layout
        mobileMenuBtn.addEventListener('click', toggleMobileSidebar);
        mobileOverlay.addEventListener('click', closeMobileSidebar);

        // Multi-Model Event Listeners
        if (multiModelCheckbox) {
            multiModelCheckbox.addEventListener('change', toggleMultiModel);
        }

        // UI Framework Event Listeners
        if (uiFramework) {
            uiFramework.addEventListener('change', handleFrameworkChange);
        }

        // File dropzone events
        ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
            fileDropzone.addEventListener(eventName, preventDefaults, false);
        });

        ['dragenter', 'dragover'].forEach(eventName => {
            fileDropzone.addEventListener(eventName, highlightDropzone, false);
        });

        ['dragleave', 'drop'].forEach(eventName => {
            fileDropzone.addEventListener(eventName, unhighlightDropzone, false);
        });

        fileDropzone.addEventListener('drop', handleDrop, false);
        fileDropzone.addEventListener('click', () => promptsFileInput.click());
        promptsFileInput.addEventListener('change', handleFileSelect);

        // JSON Import dropzone events
        ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
            jsonDropzone.addEventListener(eventName, preventDefaults, false);
        });

        ['dragenter', 'dragover'].forEach(eventName => {
            jsonDropzone.addEventListener(eventName, highlightJsonDropzone, false);
        });

        ['dragleave', 'drop'].forEach(eventName => {
            jsonDropzone.addEventListener(eventName, unhighlightJsonDropzone, false);
        });

        jsonDropzone.addEventListener('drop', handleJsonDrop, false);
        jsonDropzone.addEventListener('click', () => jsonFileInput.click());
        jsonFileInput.addEventListener('change', handleJsonFileSelect);

        // Button Group Functions
        function initializeButtonGroups() {
            // Custom Prompts Buttons
            document.querySelectorAll('.custom-prompts-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    document.querySelectorAll('.custom-prompts-btn').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    
                    const isCustom = btn.dataset.value === 'yes';
                    customPromptsContainer.classList.toggle('hidden', !isCustom);
                    
                    if (!isCustom) {
                        // Clear custom prompts when switching to "No"
                        promptsFileInput.value = '';
                        document.getElementById('customPrompts').value = '';
                        const dropzoneContent = fileDropzone.querySelector('div');
                        dropzoneContent.innerHTML = `
                            <div class="flex flex-col items-center justify-center space-y-2">
                                <i data-lucide="upload-cloud" class="w-8 h-8 text-white text-opacity-60 aurora-icon"></i>
                                <p class="text-sm text-white text-opacity-80">
                                    <span class="font-medium" style="color: var(--aurora-cyan)">Click to upload</span> or drag and drop
                                </p>
                                <p class="text-xs text-white text-opacity-60">JSON or TXT files up to 10MB</p>
                            </div>
                        `;
                        lucide.createIcons();
                    }
                });
            });
        }

        // Helper function to parse bulk prompts
        function parseBulkPrompts(text) {
            // First check for complex separator method (///-----)
            if (text.includes('///---')) {
                return parseComplexBulkPrompts(text);
            }
            
            // Then check for simple separator method (///)
            const lines = text.split('\n').map(line => line.trim()).filter(line => line.length > 0);
            const bulkPrompts = [];
            
            for (const line of lines) {
                if (line.startsWith('///')) {
                    // Remove the /// and any extra whitespace
                    const prompt = line.substring(3).trim();
                    if (prompt.length > 0) {
                        bulkPrompts.push(prompt);
                    }
                }
            }
            
            return bulkPrompts;
        }

        // Helper function to parse complex bulk prompts (multi-line with ///-----)
        function parseComplexBulkPrompts(text) {
            // Split by the complex separator pattern (/// followed by 3+ dashes)
            const separatorRegex = /\/{3,}\-{3,}/g;
            const parts = text.split(separatorRegex);
            
            const bulkPrompts = [];
            
            for (const part of parts) {
                const trimmed = part.trim();
                if (trimmed.length > 0) {
                    bulkPrompts.push(trimmed);
                }
            }
            
            return bulkPrompts;
        }

        // Helper function to check if text contains bulk prompts
        function hasBulkPrompts(text) {
            // Check for complex separator method
            if (text.includes('///---')) {
                return true;
            }
            
            // Check for simple separator method
            return text.split('\n').some(line => line.trim().startsWith('///'));
        }

        // Helper functions to get values

        function getSelectedDownloadMode() {
            return localStorage.getItem('downloadMode') || 'auto';
        }

        function getSelectedDownloadPrompts() {
            const savedValue = localStorage.getItem('downloadPrompts') || 'no';
            return savedValue === 'yes';
        }

        function getSelectedCustomPrompts() {
            const activeBtn = document.querySelector('.custom-prompts-btn.active');
            return activeBtn ? activeBtn.dataset.value === 'yes' : false;
        }



        // Animation Control Functions
        function activateGenerationAnimations() {
            const floatingBrowsers = document.getElementById('floatingBrowsers');
            if (floatingBrowsers) {
                floatingBrowsers.classList.add('generating');
            }
        }

        function deactivateGenerationAnimations() {
            const floatingBrowsers = document.getElementById('floatingBrowsers');
            if (floatingBrowsers) {
                floatingBrowsers.classList.remove('generating');
            }
            
            // Hide top progress bar
            const topProgressBar = document.getElementById('topProgressBar');
            if (topProgressBar) {
                topProgressBar.classList.add('hidden');
            }
        }

        // Fullscreen Viewer Functions
        function openFullscreenViewer(htmlContent, filename) {
            const viewer = document.getElementById('fullscreenViewer');
            const iframe = document.getElementById('fullscreenIframe');
            const title = document.getElementById('fullscreenTitle');
            
            title.textContent = filename.replace('.html', '');
            iframe.srcdoc = htmlContent;
            viewer.classList.add('active');
        }

        function closeFullscreenViewer() {
            const viewer = document.getElementById('fullscreenViewer');
            viewer.classList.remove('active');
        }

        // Generation Placeholder Functions
        function addNextDesignPlaceholder() {
            // Remove existing placeholder
            const existingPlaceholder = document.querySelector('.generating-placeholder');
            if (existingPlaceholder) {
                existingPlaceholder.remove();
            }
            
            const placeholder = document.createElement('div');
            placeholder.className = 'design-card generating-placeholder generating';
            placeholder.innerHTML = `
                <div class="design-card-header flex justify-between items-center">
                    <span class="text-xs font-medium text-white text-opacity-50">Generating...</span>
                    <div class="flex items-center space-x-1">
                        <div class="w-3 h-3 border border-aurora-cyan border-t-transparent rounded-full animate-spin opacity-60"></div>
                    </div>
                </div>
                <div class="preview-frame flex items-center justify-center" style="background: linear-gradient(to bottom right, rgba(116, 249, 255, 0.05), rgba(184, 106, 223, 0.05))">
                    <div class="text-center">
                        <i data-lucide="sparkles" class="w-8 h-8 text-white text-opacity-30 mx-auto mb-2 animate-pulse"></i>
                        <p class="text-xs text-white text-opacity-40">Creating design...</p>
                    </div>
                </div>
            `;
            
            designsGrid.appendChild(placeholder);
            lucide.createIcons();
        }

        // Initialize
        loadSettings();
        updateEmptyState();
        initializeButtonGroups();
        
        // Initialize multi-model functionality
        if (multiModelCheckbox) {
            // Set initial state
            isMultiModel = multiModelCheckbox.checked;
            
            // Load saved multi-model settings
            const savedMultiModel = localStorage.getItem('isMultiModel') === 'true';
            const savedSelectedModels = localStorage.getItem('selectedModels');
            
            if (savedMultiModel) {
                multiModelCheckbox.checked = true;
                isMultiModel = true;
                
                if (savedSelectedModels) {
                    try {
                        selectedModels = JSON.parse(savedSelectedModels);
                    } catch (e) {
                        selectedModels = [];
                    }
                }
                
                // Apply multi-model state
                modelSelectionContainer.classList.add('hidden');
                multiModelContainer.classList.remove('hidden');
                populateMultiModelList();
            }
        }

        // Initialize UI Framework functionality
        if (uiFramework) {
            handleFrameworkChange(); // Set initial state
        }

        // New Layout Functions
        function toggleMobileSidebar() {
            sidebar.classList.add('open');
            mobileOverlay.classList.remove('hidden');
        }

        function closeMobileSidebar() {
            sidebar.classList.remove('open');
            mobileOverlay.classList.add('hidden');
        }

        function updateEmptyState() {
            // Don't change state during generation - let showGenerationState handle it
            if (isGenerating) {
                return;
            }
            
            if (generatedDesigns.length === 0) {
                emptyState.classList.remove('hidden');
                resultsContainer.classList.add('hidden');
            } else {
                emptyState.classList.add('hidden');
                resultsContainer.classList.remove('hidden');
            }
        }

        function showGenerationState() {
            // Force show the empty state immediately
            emptyState.classList.remove('hidden');
            resultsContainer.classList.add('hidden');
            
            // Hide the landing page content but keep the floating browsers visible
            const welcomeContent = document.querySelector('.welcome-content-enhanced');
            if (welcomeContent) {
                welcomeContent.style.display = 'none';
            }
            
            // Activate generation animations on the floating browsers immediately
            activateGenerationAnimations();
            
            // Add a generation status overlay
            const existingOverlay = document.getElementById('generationOverlay');
            if (!existingOverlay) {
                const overlay = document.createElement('div');
                overlay.id = 'generationOverlay';
                overlay.className = 'absolute inset-0 flex items-center justify-center z-20';
                overlay.innerHTML = `
                    <div class="welcome-content-enhanced text-center">
                        <div class="empty-state-icon mb-6">
                            <i data-lucide="sparkles" class="w-20 h-20 sparkle-icon animate-pulse" style="color: var(--aurora-cyan)"></i>
                        </div>
                        <h2 class="text-3xl md:text-4xl welcome-title mb-4 text-center font-bold">
                            Generating Your Designs...
                        </h2>
                        <p class="text-lg text-center mb-6 text-white text-opacity-80 font-medium">
                            AI is crafting unique variations based on your prompt
                        </p>
                        <div class="flex items-center justify-center gap-3 text-white text-opacity-70">
                            <div class="w-2 h-2 bg-aurora-cyan rounded-full animate-bounce" style="animation-delay: 0s;"></div>
                            <div class="w-2 h-2 bg-aurora-purple rounded-full animate-bounce" style="animation-delay: 0.2s;"></div>
                            <div class="w-2 h-2 bg-aurora-pink rounded-full animate-bounce" style="animation-delay: 0.4s;"></div>
                        </div>
                    </div>
                `;
                emptyState.appendChild(overlay);
                lucide.createIcons();
            }
        }

        function hideGenerationState() {
            // Show the welcome content again
            const welcomeContent = document.querySelector('.welcome-content-enhanced');
            if (welcomeContent) {
                welcomeContent.style.display = 'flex';
            }
            
            // Remove generation overlay
            const overlay = document.getElementById('generationOverlay');
            if (overlay) {
                overlay.remove();
            }
            
            // Deactivate generation animations
            deactivateGenerationAnimations();
        }

        // Handle window resize for responsive behavior
        window.addEventListener('resize', () => {
            if (window.innerWidth >= 1024) {
                sidebar.classList.remove('open');
                mobileOverlay.classList.add('hidden');
            }
        });

        // Helper functions
        function preventDefaults(e) {
            e.preventDefault();
            e.stopPropagation();
        }

        function highlightDropzone() {
            fileDropzone.classList.add('active');
        }

        function unhighlightDropzone() {
            fileDropzone.classList.remove('active');
        }

        function handleDrop(e) {
            const dt = e.dataTransfer;
            const files = dt.files;
            if (files.length) {
                promptsFileInput.files = files;
                updateDropzoneUI(files[0]);
            }
        }

        function handleFileSelect() {
            if (promptsFileInput.files.length) {
                updateDropzoneUI(promptsFileInput.files[0]);
            }
        }

        function updateDropzoneUI(file) {
            const dropzoneContent = fileDropzone.querySelector('div');
            dropzoneContent.innerHTML = `
                <i data-lucide="file-text" class="w-8 h-8 text-indigo-500"></i>
                <p class="text-xs font-medium text-gray-700 truncate max-w-xs">${file.name}</p>
                <p class="text-xs text-gray-500">${(file.size / 1024 / 1024).toFixed(2)} MB</p>
            `;
            lucide.createIcons();
        }

        // JSON Import Functions
        function highlightJsonDropzone() {
            jsonDropzone.classList.add('active');
        }

        function unhighlightJsonDropzone() {
            jsonDropzone.classList.remove('active');
        }

        function handleJsonDrop(e) {
            const dt = e.dataTransfer;
            const files = dt.files;
            if (files.length) {
                jsonFileInput.files = files;
                handleJsonImport(files[0]);
            }
        }

        function handleJsonFileSelect() {
            if (jsonFileInput.files.length) {
                handleJsonImport(jsonFileInput.files[0]);
            }
        }

        function updateJsonDropzoneUI(file) {
            const dropzoneContent = jsonDropzone.querySelector('div');
            dropzoneContent.innerHTML = `
                <i data-lucide="file-json" class="w-8 h-8" style="color: var(--aurora-cyan)"></i>
                <p class="text-xs font-medium text-white text-opacity-80 truncate max-w-xs">${file.name}</p>
                <p class="text-xs text-white text-opacity-60">${(file.size / 1024 / 1024).toFixed(2)} MB</p>
            `;
            lucide.createIcons();
        }

        async function handleJsonImport(file) {
            try {
                if (file.size > 10 * 1024 * 1024) {
                    showToast('JSON file size exceeds 10MB limit', 'error');
                    return;
                }

                if (!file.name.toLowerCase().endsWith('.json')) {
                    showToast('Please select a JSON file', 'error');
                    return;
                }

                updateJsonDropzoneUI(file);
                showToast('Reading JSON file...', 'info');

                const fileContent = await readFileAsText(file);
                const campaignData = JSON.parse(fileContent);

                // Validate JSON structure
                if (!campaignData.appType || !campaignData.prompts) {
                    showToast('Invalid campaign JSON format', 'error');
                    return;
                }

                // Check if it's from the correct app
                if (campaignData.appType !== 'Bulk Page Generator') {
                    showToast(`This JSON is from "${campaignData.appType}", not Bulk Page Generator`, 'warning');
                    // Allow import anyway, but warn user
                }

                // Import the campaign data
                importCampaignData(campaignData);
                showToast('Campaign imported successfully!', 'success');

            } catch (error) {
                console.error('Error importing JSON:', error);
                showToast('Failed to import JSON file. Please check the file format.', 'error');
                
                // Reset dropzone UI
                const dropzoneContent = jsonDropzone.querySelector('div');
                dropzoneContent.innerHTML = `
                    <div class="flex flex-col items-center justify-center space-y-2">
                        <i data-lucide="file-json" class="w-8 h-8 text-white text-opacity-60 aurora-icon"></i>
                        <p class="text-sm text-white text-opacity-80">
                            <span class="font-medium" style="color: var(--aurora-cyan)">Click to import</span> or drag and drop
                        </p>
                        <p class="text-xs text-white text-opacity-60">JSON files from previous campaigns</p>
                    </div>
                `;
                lucide.createIcons();
            }
        }

        function importCampaignData(campaignData) {
            try {
                // Import session name
                if (campaignData.sessionName) {
                    sessionNameInput.value = campaignData.sessionName;
                }

                // Import prompts
                if (campaignData.prompts) {
                    // Import main prompt
                    if (campaignData.prompts.mainPrompt) {
                        mainPrompt.value = campaignData.prompts.mainPrompt;
                    }

                    // Import prompt modifier
                    if (campaignData.prompts.promptModifier) {
                        promptModifier.value = campaignData.prompts.promptModifier;
                    }

                    // Import UI framework
                    if (campaignData.prompts.uiFramework) {
                        uiFramework.value = campaignData.prompts.uiFramework;
                        handleFrameworkChange(); // Update UI based on selection
                    }

                    // Import custom framework if applicable
                    if (campaignData.prompts.customFramework && campaignData.prompts.uiFramework === 'custom') {
                        cssJsFramework.value = campaignData.prompts.customFramework;
                    }

                    // Import original prompts if available (for custom prompts)
                    if (campaignData.prompts.originalPrompts && campaignData.prompts.originalPrompts.length > 0) {
                        // Check if we should activate custom prompts mode
                        const hasMultiplePrompts = campaignData.prompts.originalPrompts.length > 1;
                        const isBulkInMain = campaignData.prompts.mainPrompt && hasBulkPrompts(campaignData.prompts.mainPrompt);
                        
                        if (hasMultiplePrompts && !isBulkInMain) {
                            // Activate custom prompts mode
                            document.querySelectorAll('.custom-prompts-btn').forEach(b => b.classList.remove('active'));
                            document.querySelector('.custom-prompts-btn[data-value="yes"]').classList.add('active');
                            customPromptsContainer.classList.remove('hidden');
                            
                            // Import prompts to custom prompts textarea
                            const customPromptsTextarea = document.getElementById('customPrompts');
                            customPromptsTextarea.value = campaignData.prompts.originalPrompts.join('\n');
                        }
                    }
                }

                // Import settings
                if (campaignData.settings) {
                    // Import AI model
                    if (campaignData.settings.aiModel) {
                        modalAiModel.value = campaignData.settings.aiModel;
                        mainAiModel.value = campaignData.settings.aiModel;
                    }

                    // Import multi-model settings
                    if (campaignData.settings.isMultiModel !== undefined) {
                        isMultiModel = campaignData.settings.isMultiModel;
                        if (multiModelCheckbox) {
                            multiModelCheckbox.checked = isMultiModel;
                        }
                    }

                    if (campaignData.settings.selectedModels && campaignData.settings.selectedModels.length > 0) {
                        selectedModels = campaignData.settings.selectedModels;
                    }

                    // Apply multi-model state
                    if (isMultiModel && multiModelCheckbox) {
                        modelSelectionContainer.classList.add('hidden');
                        multiModelContainer.classList.remove('hidden');
                        populateMultiModelList();
                    }
                }

                // Show import summary
                let importSummary = `Imported campaign: ${campaignData.sessionName || 'Unnamed'}`;
                if (campaignData.prompts && campaignData.prompts.totalPrompts) {
                    importSummary += `\n• ${campaignData.prompts.totalPrompts} prompts`;
                }
                if (campaignData.results && campaignData.results.totalGenerated) {
                    importSummary += `\n• ${campaignData.results.totalGenerated} previously generated designs`;
                }
                if (campaignData.exportedAt) {
                    const exportDate = new Date(campaignData.exportedAt).toLocaleString();
                    importSummary += `\n• Exported: ${exportDate}`;
                }

                showToast(importSummary, 'success');

            } catch (error) {
                console.error('Error importing campaign data:', error);
                showToast('Error importing some campaign data', 'warning');
            }
        }

        function toggleApiKeyVisibilityHandler() {
            apiKeyVisible = !apiKeyVisible;
            apiKeyInput.type = apiKeyVisible ? 'text' : 'password';
            const icon = toggleApiKeyVisibility.querySelector('i');
            icon.setAttribute('data-lucide', apiKeyVisible ? 'eye-off' : 'eye');
            lucide.createIcons();
        }

        function loadSettings() {
            const savedApiKey = localStorage.getItem('openRouterApiKey');
            const savedModel = localStorage.getItem('selectedAiModel');
            const savedDownloadMode = localStorage.getItem('downloadMode');
            const savedDownloadPrompts = localStorage.getItem('downloadPrompts');
            const savedMultiModel = localStorage.getItem('isMultiModel') === 'true';
            const savedSelectedModels = localStorage.getItem('selectedModels');
            
            if (savedApiKey) {
                apiKeyInput.value = savedApiKey;
            }
            
            if (savedModel) {
                modalAiModel.value = savedModel;
                mainAiModel.value = savedModel;
            }

            // Load download settings
            const downloadModeSelect = document.getElementById('downloadModeSelect');
            const downloadPromptsSelect = document.getElementById('downloadPromptsSelect');
            
            if (savedDownloadMode && downloadModeSelect) {
                downloadModeSelect.value = savedDownloadMode;
            }

            if (savedDownloadPrompts && downloadPromptsSelect) {
                downloadPromptsSelect.value = savedDownloadPrompts;
            }

            // Load multi-model settings
            if (multiModelCheckbox) {
                multiModelCheckbox.checked = savedMultiModel;
                isMultiModel = savedMultiModel;
                
                if (savedSelectedModels) {
                    try {
                        selectedModels = JSON.parse(savedSelectedModels);
                    } catch (e) {
                        selectedModels = [];
                    }
                }
                
                // Apply multi-model state
                if (isMultiModel) {
                    modelSelectionContainer.classList.add('hidden');
                    multiModelContainer.classList.remove('hidden');
                    populateMultiModelList();
                } else {
                    modelSelectionContainer.classList.remove('hidden');
                    multiModelContainer.classList.add('hidden');
                }
            }
        }

        function saveSettings() {
            const apiKey = apiKeyInput.value.trim();
            const selectedModel = modalAiModel.value;
            const downloadModeSelect = document.getElementById('downloadModeSelect');
            const downloadPromptsSelect = document.getElementById('downloadPromptsSelect');
            const downloadMode = downloadModeSelect ? downloadModeSelect.value : 'auto';
            const downloadPrompts = downloadPromptsSelect ? downloadPromptsSelect.value : 'no';
            
            if (!apiKey) {
                showToast('Please enter your OpenRouter API key', 'error');
                return;
            }

            // Validate multi-model selection
            if (isMultiModel && selectedModels.length === 0) {
                showToast('Please select at least one model for multi-model generation', 'error');
                return;
            }
            
            localStorage.setItem('openRouterApiKey', apiKey);
            localStorage.setItem('selectedAiModel', selectedModel);
            localStorage.setItem('downloadMode', downloadMode);
            localStorage.setItem('downloadPrompts', downloadPrompts);
            localStorage.setItem('isMultiModel', isMultiModel.toString());
            localStorage.setItem('selectedModels', JSON.stringify(selectedModels));
            
            mainAiModel.value = selectedModel;
            
            apiSettingsModal.classList.add('hidden');
            showToast('Settings saved successfully!', 'success');
        }



        // Generation functions
        async function startGeneration() {
            const mainPromptText = mainPrompt.value.trim();
            const promptModifierText = promptModifier.value.trim();
            const selectedFramework = getSelectedFramework();
            const downloadMode = getSelectedDownloadMode();
            const useCustomPrompts = getSelectedCustomPrompts();
            const downloadPrompts = getSelectedDownloadPrompts();
            const apiKey = localStorage.getItem('openRouterApiKey');
            const model = mainAiModel.value;

            if (!apiKey) {
                showToast('Please set your OpenRouter API key in the settings first.', 'error');
                return;
            }

            if (!mainPromptText && !useCustomPrompts) {
                showToast('Please enter a main prompt or provide custom prompts.', 'error');
                return;
            }

            // Check for bulk prompts in main prompt field
            const isBulkPrompts = !useCustomPrompts && hasBulkPrompts(mainPromptText);
            let bulkPromptsList = [];
            
            if (isBulkPrompts) {
                bulkPromptsList = parseBulkPrompts(mainPromptText);
                if (bulkPromptsList.length === 0) {
                    showToast('No valid bulk prompts found. Please ensure each prompt starts with "*".', 'error');
                    return;
                }
                const separatorType = mainPromptText.includes('///---') ? 'complex' : 'simple';
                showToast(`Detected ${bulkPromptsList.length} bulk prompts (${separatorType} method). Generating ${bulkPromptsList.length} pages.`, 'info');
            }

            // Disable generate button during generation and add animation
            generateBtn.disabled = true;
            generateBtn.classList.add('generating');
            generateBtn.innerHTML = '<i data-lucide="loader" class="w-4 h-4 animate-spin"></i><span class="text-sm">Generating...</span>';
            lucide.createIcons();

            // Prepare prompts
            if (useCustomPrompts) {
                const fileInput = document.getElementById('promptsFile');
                const customPromptsText = document.getElementById('customPrompts').value.trim();
                
                if (fileInput.files.length > 0) {
                    try {
                        const file = fileInput.files[0];
                        if (file.size > 10 * 1024 * 1024) {
                            showToast('File size exceeds 10MB limit', 'error');
                            resetGenerateButton();
                            return;
                        }
                        const fileContent = await readFileAsText(file);
                        prompts = parsePromptsFromFile(fileContent);
                    } catch (error) {
                        console.error('Error reading prompts file:', error);
                        showToast('Error reading prompts file. Please try again.', 'error');
                        resetGenerateButton();
                        return;
                    }
                } else if (customPromptsText) {
                    // Check if custom prompts use bulk separators
                    if (hasBulkPrompts(customPromptsText)) {
                        prompts = parseBulkPrompts(customPromptsText);
                    } else {
                        // Default: split by lines
                        prompts = customPromptsText.split('\n').filter(p => p.trim());
                    }
                } else {
                    showToast('Please provide custom prompts either by uploading a file or pasting them in the text area.', 'error');
                    resetGenerateButton();
                    return;
                }
            } else if (isBulkPrompts) {
                // Handle bulk prompts - apply prompt modifier if provided
                if (promptModifierText) {
                    prompts = bulkPromptsList.map(prompt => `${prompt} ${promptModifierText}`);
                    showToast(`Applied prompt modifier to ${bulkPromptsList.length} bulk prompts`, 'info');
                } else {
                    prompts = [...bulkPromptsList];
                }
                showToast(`Processing ${prompts.length} bulk prompts...`, 'info');
                
                // Check if user wants to download bulk prompts
                if (downloadPrompts) {
                    showToast('Downloading bulk prompts file...', 'info');
                    setTimeout(() => {
                        downloadPromptsFile(prompts, 'bulk-prompts-list');
                    }, 500);
                }
            } else {
                // Single prompt - apply prompt modifier if provided
                if (promptModifierText) {
                    prompts = [`${mainPromptText} ${promptModifierText}`];
                    showToast(`Applied prompt modifier to main prompt`, 'info');
                } else {
                    prompts = [mainPromptText];
                }
                showToast(`Generating page for: "${mainPromptText.substring(0, 50)}..."`, 'info');
                
                // Check if user wants to download prompts
                if (downloadPrompts) {
                    showToast('Downloading prompt file...', 'info');
                    setTimeout(() => {
                        downloadPromptsFile(prompts, mainPromptText);
                    }, 500);
                }
            }

            if (prompts.length === 0) {
                showToast('No valid prompts to generate from.', 'error');
                resetGenerateButton();
                return;
            }

            // Apply prompt modifier to custom prompts if provided
            if (useCustomPrompts && promptModifierText) {
                prompts = prompts.map(prompt => `${prompt} ${promptModifierText}`);
                showToast(`Applied prompt modifier to ${prompts.length} custom prompts`, 'info');
            }

            // Handle download prompts for custom prompts case
            if (useCustomPrompts && downloadPrompts) {
                const customPromptSource = promptsFileInput.files.length > 0 ? 'uploaded-file' : 'custom-input';
                showToast('Downloading custom prompts file...', 'info');
                setTimeout(() => {
                    downloadPromptsFile(prompts, `custom-prompts-${customPromptSource}`);
                }, 500);
            }

            // Initialize generation state
            isGenerating = true;
            isPaused = false;
            currentIndex = 0;
            generatedDesigns = [];
            designsGrid.innerHTML = '';
            generationQueue = [...prompts];
            
            // Show animated generation state
            showGenerationState();
            
            // Get selected models for generation
            const modelsToUse = getSelectedModels();
            const totalGenerations = isMultiModel ? prompts.length * modelsToUse.length : prompts.length;
            
            // Determine the source of prompts for logging
            let promptSource = '';
            if (useCustomPrompts) {
                promptSource = 'custom prompts';
            } else if (isBulkPrompts) {
                promptSource = 'bulk prompts';
            } else {
                promptSource = 'single prompt';
            }
            
            // Show progress
            if (progressContainer) progressContainer.classList.remove('hidden');
            if (headerProgressContainer) headerProgressContainer.classList.remove('hidden');
            if (completedCount) completedCount.textContent = '0';
            if (totalCount) totalCount.textContent = totalGenerations;
            if (headerCompletedCount) headerCompletedCount.textContent = '0';
            if (headerTotalCount) headerTotalCount.textContent = totalGenerations;
            if (progressFill) progressFill.style.width = '0%';
            if (statusText) {
                statusText.textContent = isMultiModel ? `Generating pages with ${modelsToUse.length} models...` : `Generating pages...`;
                statusText.className = 'font-medium status-generating';
            }
            if (headerStatusText) {
                headerStatusText.textContent = isMultiModel ? `Multi-Model (${modelsToUse.length})` : `Generating`;
                headerStatusText.className = 'text-sm font-medium status-generating';
            }
            
            // Show multi-model info
            if (isMultiModel) {
                showToast(`Multi-model generation: ${modelsToUse.length} models × ${prompts.length} prompts = ${totalGenerations} pages`, 'info');
            }
            
            // Show top progress bar
            const topProgressBar = document.getElementById('topProgressBar');
            topProgressBar.classList.remove('hidden');
            
            // Start processing
            processNextPrompt();
        }

        function resetGenerateButton() {
            generateBtn.disabled = false;
            generateBtn.classList.remove('generating');
            generateBtn.innerHTML = '<i data-lucide="code" class="w-4 h-4"></i><span class="text-sm">Generate Pages</span>';
            lucide.createIcons();
        }

        async function processNextPrompt() {
            if (!isGenerating || isPaused || currentIndex >= prompts.length) {
                if (currentIndex >= prompts.length) {
                    // Generation complete
                    isGenerating = false;
                    if (statusText) {
                        statusText.textContent = 'Generation complete!';
                        statusText.className = 'font-medium status-complete';
                    }
                    if (headerStatusText) {
                        headerStatusText.textContent = 'Complete!';
                        headerStatusText.className = 'text-sm font-medium status-complete';
                    }
                    if (currentPromptDisplay) currentPromptDisplay.classList.add('hidden');
                    showToast('All pages generated successfully!', 'success');
                    resetGenerateButton();
                    hideGenerationState();
                    updateEmptyState();
                }
                return;
            }

            const currentPrompt = prompts[currentIndex];
            const apiKey = localStorage.getItem('openRouterApiKey');
            const model = mainAiModel.value;
            const downloadMode = getSelectedDownloadMode();
            const selectedFramework = getSelectedFramework();

            try {
                if (statusText) statusText.textContent = `Generating page ${currentIndex + 1} of ${prompts.length}`;
                if (headerStatusText) headerStatusText.textContent = `Generating ${currentIndex + 1}/${prompts.length}`;
                
                // Show current prompt in UI
                if (currentPromptText) {
                    currentPromptText.textContent = currentPrompt.length > 100 ? 
                        currentPrompt.substring(0, 100) + '...' : currentPrompt;
                }
                if (currentPromptDisplay) currentPromptDisplay.classList.remove('hidden');
                
                // Debug: Log the current prompt being processed
                console.log(`Processing prompt ${currentIndex + 1}:`, currentPrompt);
                
                const htmlContent = await generateHtmlPage(currentPrompt, selectedFramework, apiKey, model);
                
                // Create design preview
                const designId = `design-${Date.now()}-${currentIndex}`;
                const filename = generateFilename(currentPrompt, htmlContent);
                
                const designCard = document.createElement('div');
                designCard.className = 'design-card';
                designCard.innerHTML = `
                    <div class="design-card-header flex justify-between items-center">
                        <span class="text-xs font-medium text-white truncate flex-1" title="${filename}">${filename}</span>
                        <div class="flex items-center space-x-1">
                            <button class="glass-button p-1.5 rounded open-full" title="Open in new window">
                                <i data-lucide="external-link" class="w-3 h-3 aurora-icon"></i>
                            </button>
                            <button class="glass-button p-1.5 rounded fullscreen-btn" title="Full Screen" style="color: var(--aurora-purple);">
                                <i data-lucide="maximize-2" class="w-3 h-3 aurora-icon"></i>
                            </button>
                            <button class="glass-button p-1.5 rounded download-btn" title="Download" style="color: var(--aurora-cyan);">
                                <i data-lucide="download" class="w-3 h-3 aurora-icon"></i>
                            </button>
                            <button class="glass-button p-1.5 rounded reject-btn" title="Reject" style="color: var(--aurora-pink);">
                                <i data-lucide="trash-2" class="w-3 h-3 aurora-icon"></i>
                            </button>
                        </div>
                    </div>
                    <div class="preview-frame">
                        <iframe class="w-full h-full" srcdoc="${escapeHtml(htmlContent)}"></iframe>
                    </div>
                `;
                
                designsGrid.appendChild(designCard);
                lucide.createIcons();
                
                // Remove generation overlay when first design appears
                if (currentIndex === 1) {
                    const overlay = document.getElementById('generationOverlay');
                    if (overlay) {
                        overlay.remove();
                    }
                    // Switch to results view but keep generation animations
                    emptyState.classList.add('hidden');
                    resultsContainer.classList.remove('hidden');
                    // Keep generation animations active until completion
                }
                
                // Add generation animation to the next design slot if available
                if (currentIndex + 1 < prompts.length) {
                    addNextDesignPlaceholder();
                }
                
                // Add event listeners
                designCard.querySelector('.open-full').addEventListener('click', () => {
                    openDesignInNewWindow(htmlContent, filename);
                });
                
                designCard.querySelector('.fullscreen-btn').addEventListener('click', () => {
                    openFullscreenViewer(htmlContent, filename);
                });
                
                designCard.querySelector('.download-btn').addEventListener('click', () => {
                    downloadDesign(htmlContent, filename);
                });
                
                designCard.querySelector('.reject-btn').addEventListener('click', () => {
                    designCard.remove();
                    generatedDesigns = generatedDesigns.filter(d => d.id !== designId);
                    updateEmptyState();
                });
                
                // Store design data
                generatedDesigns.push({
                    id: designId,
                    prompt: currentPrompt,
                    html: htmlContent,
                    filename: filename
                });
                
                // Auto download if enabled
                if (downloadMode === 'auto') {
                    downloadDesign(htmlContent, filename);
                }
                
                // Update progress
                currentIndex++;
                if (completedCount) completedCount.textContent = currentIndex;
                if (headerCompletedCount) headerCompletedCount.textContent = currentIndex;
                if (progressFill) progressFill.style.width = `${(currentIndex / prompts.length) * 100}%`;
                
                // Update top progress bar
                const topProgressFill = document.querySelector('.top-progress-fill');
                if (topProgressFill) {
                    topProgressFill.style.width = `${(currentIndex / prompts.length) * 100}%`;
                }
                
                // Remove previous generation placeholder
                const prevPlaceholder = document.querySelector('.generating-placeholder');
                if (prevPlaceholder) {
                    prevPlaceholder.remove();
                }
                
                updateEmptyState();
                
                // Process next prompt with delay to prevent rate limiting
                setTimeout(processNextPrompt, 1500);
            } catch (error) {
                console.error('Error generating design:', error);
                currentIndex++;
                completedCount.textContent = currentIndex;
                progressFill.style.width = `${(currentIndex / prompts.length) * 100}%`;
                setTimeout(processNextPrompt, 1500);
            }
        }

        function pauseGeneration() {
            if (!isGenerating) return;
            
            isPaused = true;
            if (pauseBtn) pauseBtn.classList.add('hidden');
            if (resumeBtn) resumeBtn.classList.remove('hidden');
            if (headerPauseBtn) headerPauseBtn.classList.add('hidden');
            if (headerResumeBtn) headerResumeBtn.classList.remove('hidden');
            if (statusText) {
                statusText.textContent = 'Paused';
                statusText.className = 'font-medium status-paused';
            }
            if (headerStatusText) {
                headerStatusText.textContent = 'Paused';
                headerStatusText.className = 'text-sm font-medium status-paused';
            }
            showToast('Generation paused', 'warning');
        }

        function resumeGeneration() {
            if (!isGenerating) return;
            
            isPaused = false;
            if (pauseBtn) pauseBtn.classList.remove('hidden');
            if (resumeBtn) resumeBtn.classList.add('hidden');
            if (headerPauseBtn) headerPauseBtn.classList.remove('hidden');
            if (headerResumeBtn) headerResumeBtn.classList.add('hidden');
            if (statusText) {
                statusText.textContent = 'Generating...';
                statusText.className = 'font-medium status-generating';
            }
            if (headerStatusText) {
                headerStatusText.textContent = 'Generating...';
                headerStatusText.className = 'text-sm font-medium status-generating';
            }
            showToast('Generation resumed', 'info');
            processNextPrompt();
        }

        function stopGeneration() {
            isGenerating = false;
            isPaused = false;
            if (statusText) {
                statusText.textContent = 'Stopped';
                statusText.className = 'font-medium status-error';
            }
            if (headerStatusText) {
                headerStatusText.textContent = 'Stopped';
                headerStatusText.className = 'text-sm font-medium status-error';
            }
            if (currentPromptDisplay) currentPromptDisplay.classList.add('hidden');
            showToast('Generation stopped', 'error');
            resetGenerateButton();
            hideGenerationState();
            updateEmptyState();
        }

        function escapeHtml(unsafe) {
            return unsafe
                .replace(/&/g, "&amp;")
                .replace(/</g, "&lt;")
                .replace(/>/g, "&gt;")
                .replace(/"/g, "&quot;")
                .replace(/'/g, "&#039;");
        }

        function extractMetaTitle(htmlContent) {
            try {
                // Extract title from HTML content
                const titleMatch = htmlContent.match(/<title[^>]*>(.*?)<\/title>/i);
                if (titleMatch && titleMatch[1]) {
                    let title = titleMatch[1].trim();
                    
                    // Clean up common unwanted text
                    title = title
                        .replace(/\s*-\s*Home\s*$/i, '')
                        .replace(/\s*-\s*Website\s*$/i, '')
                        .replace(/\s*-\s*Official\s*$/i, '')
                        .replace(/\s*-\s*Main\s*$/i, '')
                        .replace(/\s*Home\s*Page\s*$/i, '')
                        .replace(/\s*Website\s*$/i, '')
                        .replace(/\s*Official\s*$/i, '')
                        .replace(/\s*Page\s*$/i, '')
                        .trim();
                    
                    if (title.length > 0) {
                        return title;
                    }
                }
                return null;
            } catch (error) {
                console.log('Error extracting meta title:', error);
                return null;
            }
        }

        function generateFilename(prompt, htmlContent = null) {
            let baseName = '';
            
            // Try to extract meta title from HTML content first
            if (htmlContent) {
                const metaTitle = extractMetaTitle(htmlContent);
                if (metaTitle) {
                    baseName = metaTitle;
                    console.log(`📄 Using meta title for filename: "${metaTitle}"`);
                }
            }
            
            // Fallback to prompt-based filename if no meta title found
            if (!baseName) {
                baseName = prompt;
                console.log(`📝 Using prompt for filename (no meta title found)`);
            }
            
            // Sanitize the base name
            let sanitized = baseName
                .toLowerCase()
                .replace(/[^a-z0-9\s-]/g, '')
                .replace(/\s+/g, '-')
                .substring(0, 50) // Increased length to accommodate product names
                .replace(/-+$/, '');
            
            // Remove common prefixes and suffixes
            sanitized = sanitized
                .replace(/^design-/, '')
                .replace(/^website-/, '')
                .replace(/^page-/, '')
                .replace(/^a-/, '')
                .replace(/^an-/, '')
                .replace(/^the-/, '')
                .replace(/-website$/, '')
                .replace(/-page$/, '')
                .replace(/-home$/, '');
            
            // Ensure we have a valid name
            if (!sanitized || sanitized.length < 3) {
                sanitized = 'design';
            }
            
            // Generate 3 random digits for uniqueness
            const randomDigits = Math.floor(Math.random() * 900) + 100;
            
            const finalFilename = `${sanitized}-${randomDigits}.html`;
            console.log(`📁 Generated filename: "${finalFilename}"`);
            
            return finalFilename;
        }

        function readFileAsText(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = event => resolve(event.target.result);
                reader.onerror = error => reject(error);
                reader.readAsText(file);
            });
        }

        function parsePromptsFromFile(content) {
            try {
                // Try to parse as JSON
                const json = JSON.parse(content);
                if (Array.isArray(json)) {
                    return json.filter(p => typeof p === 'string' && p.trim());
                }
                if (typeof json === 'object' && json.prompts) {
                    return json.prompts.filter(p => typeof p === 'string' && p.trim());
                }
                return [content]; // Fallback to using the whole content as one prompt
            } catch (e) {
                // Not JSON, treat as plain text
                // Check if content uses bulk separators
                if (hasBulkPrompts(content)) {
                    return parseBulkPrompts(content);
                } else {
                    // Default: split by lines
                    return content.split('\n').filter(p => p.trim());
                }
            }
        }

        function downloadDesign(htmlContent, filename) {
            try {
                const blob = new Blob([htmlContent], { type: 'text/html' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                setTimeout(() => URL.revokeObjectURL(url), 100);
            } catch (error) {
                console.error('Error downloading design:', error);
                showToast('Failed to download design', 'error');
            }
        }

        function downloadPromptsFile(prompts, originalPrompt) {
            try {
                // Create content for the prompts file
                const timestamp = new Date().toISOString().replace(/[:.]/g, '-').slice(0, -5);
                const filename = `prompts-${originalPrompt.toLowerCase().replace(/[^a-z0-9\s-]/g, '').replace(/\s+/g, '-').substring(0, 30)}-${timestamp}.txt`;
                
                let content = `Generated Prompt Variations\n`;
                content += `Generated on: ${new Date().toLocaleString()}\n`;
                content += `Original Prompt: ${originalPrompt}\n`;
                content += `Total Variations: ${prompts.length}\n`;
                content += `${'='.repeat(80)}\n\n`;
                
                prompts.forEach((prompt, index) => {
                    content += `${index + 1}. ${prompt}\n\n`;
                });
                
                content += `${'='.repeat(80)}\n`;
                content += `End of Generated Variations\n`;
                
                const blob = new Blob([content], { type: 'text/plain' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                setTimeout(() => URL.revokeObjectURL(url), 100);
                
                showToast(`Prompts saved as ${filename}`, 'success');
            } catch (error) {
                console.error('Error downloading prompts:', error);
                showToast('Failed to download prompts', 'error');
            }
        }

        function openDesignInNewWindow(htmlContent, filename) {
            const win = window.open('', '_blank');
            win.document.write(htmlContent);
            win.document.title = filename.replace('.html', '');
            win.document.close();
        }

        function downloadAllDesigns() {
            if (generatedDesigns.length === 0) {
                showToast('No pages to download', 'warning');
                return;
            }
            
            // Create a zip file if there are many pages
            if (generatedDesigns.length > 5) {
                showToast(`Preparing download for ${generatedDesigns.length} pages...`, 'info');
                setTimeout(() => {
                    generatedDesigns.forEach((design, index) => {
                        setTimeout(() => {
                            downloadDesign(design.html, design.filename);
                        }, index * 300);
                    });
                }, 500);
            } else {
                generatedDesigns.forEach(design => {
                    downloadDesign(design.html, design.filename);
                });
            }
            
            showToast(`Downloaded ${generatedDesigns.length} pages`, 'success');
        }

        function exportCampaignJson() {
            if (generatedDesigns.length === 0) {
                showToast('No campaign data to export', 'warning');
                return;
            }

            try {
                // Get session name or generate default filename
                const sessionName = sessionNameInput.value.trim();
                const timestamp = new Date().toISOString().replace(/[:.]/g, '-').slice(0, -5);
                const randomNum = Math.floor(Math.random() * 90000) + 10000; // 5-digit random number
                
                let filename;
                if (sessionName) {
                    filename = `${sessionName.toLowerCase().replace(/[^a-z0-9\s-]/g, '').replace(/\s+/g, '-')}.json`;
                } else {
                    filename = `page-generator-${randomNum}.json`;
                }

                // Prepare campaign data
                const campaignData = {
                    sessionName: sessionName || null,
                    appType: 'Bulk Page Generator',
                    exportedAt: new Date().toISOString(),
                    timestamp: timestamp,
                    settings: {
                        aiModel: mainAiModel.value,
                        downloadMode: getSelectedDownloadMode(),
                        downloadPrompts: getSelectedDownloadPrompts(),
                        isMultiModel: isMultiModel,
                        selectedModels: isMultiModel ? selectedModels : []
                    },
                    prompts: {
                        mainPrompt: mainPrompt.value.trim(),
                        promptModifier: promptModifier.value.trim(),
                        uiFramework: uiFramework.value,
                        customFramework: uiFramework.value === 'custom' ? cssJsFramework.value.trim() : null,
                        originalPrompts: prompts,
                        totalPrompts: prompts.length
                    },
                    results: {
                        totalGenerated: generatedDesigns.length,
                        designs: generatedDesigns.map(design => ({
                            id: design.id,
                            filename: design.filename,
                            prompt: design.prompt,
                            htmlLength: design.html.length,
                            // Note: HTML content not included to keep file size manageable
                            // Users can download individual pages separately
                        }))
                    },
                    statistics: {
                        generationStarted: isGenerating,
                        currentIndex: currentIndex,
                        completedCount: generatedDesigns.length,
                        successRate: prompts.length > 0 ? Math.round((generatedDesigns.length / prompts.length) * 100) : 0
                    }
                };

                // Create and download JSON file
                const jsonString = JSON.stringify(campaignData, null, 2);
                const blob = new Blob([jsonString], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                setTimeout(() => URL.revokeObjectURL(url), 100);

                showToast(`Campaign exported as ${filename}`, 'success');
            } catch (error) {
                console.error('Error exporting campaign:', error);
                showToast('Failed to export campaign', 'error');
            }
        }

        function showToast(message, type = 'info') {
            // Remove existing toasts
            document.querySelectorAll('.toast').forEach(toast => toast.remove());
            
            const colors = {
                info: '',
                success: '',
                warning: '',
                error: ''
            };
            
            const textColors = {
                info: 'var(--aurora-cyan)',
                success: '#4ade80',
                warning: '#fbbf24',
                error: 'var(--aurora-pink)'
            };
            
            const icons = {
                info: 'info',
                success: 'check-circle-2',
                warning: 'alert-triangle',
                error: 'x-circle'
            };
            
            const toast = document.createElement('div');
            toast.className = 'glass-card fixed bottom-6 right-6 px-4 py-3 flex items-center gap-3 z-50 fade-up';
            toast.style.borderColor = textColors[type];
            toast.innerHTML = `
                <i data-lucide="${icons[type]}" class="w-5 h-5 aurora-icon" style="color: ${textColors[type]}"></i>
                <span class="text-sm font-medium text-white">${message}</span>
            `;
            
            document.body.appendChild(toast);
            lucide.createIcons();
            
            // Auto-remove after delay
            setTimeout(() => {
                toast.remove();
            }, 5000);
        }



        async function generateHtmlPage(prompt, frameworkCode = '', apiKey, model) {
            try {
                if (debugMode) {
                    console.log('🎨 Generating HTML page:', { prompt, frameworkCode, model });
                }

                // System prompt for page generation with CSS/JS framework
                const systemPrompt = `You are a professional web developer. Create HTML pages that EXACTLY match the prompt requirements.

📋 TECHNICAL REQUIREMENTS:
- Use only HTML, CSS, and JavaScript
- Include provided CSS/JS framework if specified
- Enclose everything within <html>...</html> tags (no content outside)
- Ensure responsive design with mobile-first approach
- Use semantic HTML structure

🎯 FRAMEWORK INTEGRATION:
- If CSS/JS framework is provided, integrate it properly into the HTML
- Use the framework's classes and components appropriately
- Ensure the framework enhances rather than conflicts with the design
- If no framework is provided, create clean, modern CSS

⚠️ CRITICAL: Follow the prompt specifications precisely. The page must serve the exact purpose mentioned in the prompt.`;
                
                let userPrompt = `Create a complete HTML page for: ${prompt}`;
                
                if (frameworkCode) {
                    userPrompt += `\n\nIMPORTANT: Include and use this CSS/JS framework in the <head> section:\n${frameworkCode}`;
                }
                
                userPrompt += `\n\nGenerate the complete HTML page now:`;
                
                const messages = [
                    {
                        role: "system",
                        content: systemPrompt
                    },
                    {
                        role: "user",
                        content: userPrompt
                    }
                ];

                const response = await fetch('https://openrouter.ai/api/v1/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${apiKey}`,
                        'Content-Type': 'application/json',
                        'HTTP-Referer': window.location.href,
                        'X-Title': 'Bulk Page Generator'
                    },
                    body: JSON.stringify({
                        model: model,
                        messages: messages,
                        temperature: 0.7,
                        max_tokens: 12000,
                        top_p: 0.95
                    })
                });

                if (!response.ok) {
                    const errorText = await response.text();
                    throw new Error(`API request failed with status ${response.status}: ${errorText}`);
                }

                const data = await response.json();
                const rawHtml = data.choices[0].message.content;
                
                if (debugMode) {
                    console.log('✅ HTML page generated successfully, length:', rawHtml.length);
                }

                return extractHtmlFromResponse(rawHtml);
                
            } catch (error) {
                console.error('❌ HTML page generation failed:', error);
                throw error;
            }
        }



        function extractHtmlFromResponse(response) {
            // 1. Try to extract from code block first
            const codeBlockMatch = response.match(/```(?:html)?\s*([\s\S]*?)```/i);
            if (codeBlockMatch) {
                // Remove any leading text before <html or <!DOCTYPE
                const htmlStart = codeBlockMatch[1].search(/<html|<!DOCTYPE/i);
                if (htmlStart !== -1) {
                    return codeBlockMatch[1].slice(htmlStart).trim();
                }
                return codeBlockMatch[1].trim();
            }
            // 2. If no code block, find the first <html or <!DOCTYPE
            const htmlStart = response.search(/<html|<!DOCTYPE/i);
            if (htmlStart !== -1) {
                return response.slice(htmlStart).trim();
            }
            // 3. Fallback: return the whole response
            return response.trim();
        }

        // Multi-Model Functions
        function toggleMultiModel() {
            isMultiModel = multiModelCheckbox.checked;
            
            if (isMultiModel) {
                modelSelectionContainer.classList.add('hidden');
                multiModelContainer.classList.remove('hidden');
                populateMultiModelList();
            } else {
                modelSelectionContainer.classList.remove('hidden');
                multiModelContainer.classList.add('hidden');
                selectedModels = [];
            }
        }

        function populateMultiModelList() {
            if (!multiModelList) return;
            
            const models = [
                // DeepSeek Models (Free)
                { value: "deepseek/deepseek-v3-0324:free", label: "DeepSeek V3 0324 (Mar 2025) - 685B params - 164K ctx", group: "DeepSeek (Free)" },
                { value: "deepseek/deepseek-r1-zero:free", label: "DeepSeek R1 Zero (Jan 2025) - 671B params - 164K ctx", group: "DeepSeek (Free)" },
                { value: "deepseek/deepseek-r1-distill-qwen-32b:free", label: "DeepSeek R1 Distill Qwen 32B (Feb 2025) - 32B params - 16K ctx", group: "DeepSeek (Free)" },
                { value: "deepseek/deepseek-r1-distill-qwen-14b:free", label: "DeepSeek R1 Distill Qwen 14B (Feb 2025) - 14B params - 64K ctx", group: "DeepSeek (Free)" },
                { value: "deepseek/deepseek-r1-distill-llama-70b:free", label: "DeepSeek R1 Distill Llama 70B (Feb 2025) - 70B params - 8K ctx", group: "DeepSeek (Free)" },
                { value: "deepseek/deepseek-r1:free", label: "DeepSeek R1 (Jan 2025) - 671B params - 164K ctx", group: "DeepSeek (Free)" },
                { value: "deepseek/deepseek-v3:free", label: "DeepSeek V3 (Dec 2024) - 685B params - 164K ctx", group: "DeepSeek (Free)" },
                { value: "deepseek/deepseek-chat-v3-0324:free", label: "DeepSeek Chat V3 0324 (Mar 2025) - 685B params - 128K ctx", group: "DeepSeek (Free)" },
                
                // Google Models (Free)
                { value: "google/gemini-2.5-pro-exp-03-25:free", label: "Gemini 2.5 Pro Experimental (Mar 2025) - 1M ctx", group: "Google (Free)" },
                { value: "google/gemma-3-27b-it:free", label: "Gemma 3 27B (Mar 2025) - 27B params - 131K ctx", group: "Google (Free)" },
                { value: "google/gemini-2.0-flash-exp:free", label: "Gemini 2.0 Flash Experimental (Dec 2024) - 1M ctx", group: "Google (Free)" },
                { value: "google/learnlm-1.5-pro-experimental", label: "LearnLM 1.5 Pro Experimental (Nov 2024) - 40K ctx", group: "Google (Free)" },
                
                // Qwen Models (Free)
                { value: "qwen/qwen3-30b-a3b:free", label: "Qwen3-30B-A3B (Apr 2025) - 30B params - 128K ctx", group: "Qwen (Free)" },
                { value: "qwen/qwen3-235b-a22b:free", label: "Qwen3-235B-A22B (Apr 2025) - 235B params - 128K ctx", group: "Qwen (Free)" },
                { value: "qwen/qwen-2.5-coder-32b-instruct:free", label: "Qwen 2.5 Coder 32B Instruct (Nov 2024) - 32B params - 131K ctx", group: "Qwen (Free)" },
                { value: "qwen/qwen-2.5-72b-instruct:free", label: "Qwen 2.5 72B Instruct (Sep 2024) - 72B params - 131K ctx", group: "Qwen (Free)" },
                
                // Meta Models (Free)
                { value: "meta-llama/llama-3.2-90b-vision-instruct:free", label: "Llama 3.2 90B Vision Instruct (Sep 2024) - 90B params - 131K ctx", group: "Meta (Free)" },
                { value: "meta-llama/llama-3.2-11b-vision-instruct:free", label: "Llama 3.2 11B Vision Instruct (Sep 2024) - 11B params - 131K ctx", group: "Meta (Free)" },
                { value: "meta-llama/llama-3.2-3b-instruct:free", label: "Llama 3.2 3B Instruct (Sep 2024) - 3B params - 131K ctx", group: "Meta (Free)" },
                { value: "meta-llama/llama-3.2-1b-instruct:free", label: "Llama 3.2 1B Instruct (Sep 2024) - 1B params - 131K ctx", group: "Meta (Free)" },
                { value: "meta-llama/llama-3.1-8b-instruct:free", label: "Llama 3.1 8B Instruct (Jul 2024) - 8B params - 131K ctx", group: "Meta (Free)" },
                
                // Microsoft Models (Free)
                { value: "microsoft/phi-3-mini-128k-instruct:free", label: "Phi-3 Mini 128K Instruct (Apr 2024) - 3.8B params - 128K ctx", group: "Microsoft (Free)" },
                { value: "microsoft/phi-3-medium-128k-instruct:free", label: "Phi-3 Medium 128K Instruct (Apr 2024) - 14B params - 128K ctx", group: "Microsoft (Free)" },
                
                // Mistral Models (Free)
                { value: "mistralai/mistral-7b-instruct:free", label: "Mistral 7B Instruct v0.1 (Sep 2023) - 7B params - 32K ctx", group: "Mistral (Free)" },
                { value: "mistralai/codestral-mamba:free", label: "Codestral Mamba (Jul 2024) - 7B params - 256K ctx", group: "Mistral (Free)" },
                
                // Hugging Face Models (Free)
                { value: "huggingfaceh4/zephyr-7b-beta:free", label: "Zephyr 7B Beta (Oct 2023) - 7B params - 32K ctx", group: "Hugging Face (Free)" },
                
                // OpenChat Models (Free)
                { value: "openchat/openchat-7b:free", label: "OpenChat 7B (Jul 2023) - 7B params - 8K ctx", group: "OpenChat (Free)" },
                
                // Gryphe Models (Free)
                { value: "gryphe/mythomist-7b:free", label: "MythoMist 7B (Jan 2024) - 7B params - 32K ctx", group: "Gryphe (Free)" },
                
                // Undi95 Models (Free)
                { value: "undi95/toppy-m-7b:free", label: "Toppy M 7B (Dec 2023) - 7B params - 4K ctx", group: "Undi95 (Free)" }
            ];

            let currentGroup = '';
            let html = '';
            
            models.forEach(model => {
                if (model.group !== currentGroup) {
                    if (currentGroup !== '') html += '</div>';
                    html += `<div class="mb-3"><h4 class="text-xs font-semibold text-white text-opacity-70 mb-2">${model.group}</h4>`;
                    currentGroup = model.group;
                }
                
                html += `
                    <label class="flex items-start gap-2 cursor-pointer p-2 rounded hover:bg-white hover:bg-opacity-5 transition-colors">
                        <input type="checkbox" value="${model.value}" class="aurora-checkbox mt-0.5 model-checkbox" ${selectedModels.includes(model.value) ? 'checked' : ''}>
                        <span class="text-xs text-white text-opacity-80 leading-tight">${model.label}</span>
                    </label>
                `;
            });
            
            if (currentGroup !== '') html += '</div>';
            
            multiModelList.innerHTML = html;
            lucide.createIcons();
            
            // Add event listeners to checkboxes
            document.querySelectorAll('.model-checkbox').forEach(checkbox => {
                checkbox.addEventListener('change', updateSelectedModels);
            });
            
            updateSelectedModelCount();
        }

        function updateSelectedModels() {
            const checkboxes = document.querySelectorAll('.model-checkbox:checked');
            selectedModels = Array.from(checkboxes).map(cb => cb.value);
            
            // Limit to 10 models
            if (selectedModels.length > 10) {
                const lastCheckbox = document.querySelector('.model-checkbox:checked:last-of-type');
                if (lastCheckbox) {
                    lastCheckbox.checked = false;
                    selectedModels.pop();
                }
                showToast('Maximum 10 models allowed', 'warning');
            }
            
            updateSelectedModelCount();
        }

        function updateSelectedModelCount() {
            if (selectedModelCount) {
                selectedModelCount.textContent = selectedModels.length;
            }
        }

        function getSelectedModels() {
            if (isMultiModel) {
                return selectedModels.length > 0 ? selectedModels : [modalAiModel.value];
            }
            return [modalAiModel.value];
        }

        // UI Framework Functions
        function handleFrameworkChange() {
            const selectedFramework = uiFramework.value;
            if (selectedFramework === 'custom') {
                customFrameworkSection.classList.remove('hidden');
            } else {
                customFrameworkSection.classList.add('hidden');
            }
        }

        function getFrameworkCDN(framework) {
            const frameworks = {
                'tailwind': '<script src="https://cdn.tailwindcss.com"><\/script>',
                
                'bootstrap': '<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">\\n<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"><\/script>',
                
                'daisyui': '<script src="https://cdn.tailwindcss.com"><\/script>\\n<link href="https://cdn.jsdelivr.net/npm/daisyui@latest/dist/full.css" rel="stylesheet">',
                
                'flowbite': '<script src="https://cdn.tailwindcss.com"><\/script>\\n<link href="https://unpkg.com/flowbite@latest/dist/flowbite.min.css" rel="stylesheet">\\n<script src="https://unpkg.com/flowbite@latest/dist/flowbite.min.js"><\/script>',
                
                'preline': '<script src="https://cdn.tailwindcss.com"><\/script>\\n<link href="https://cdn.jsdelivr.net/npm/preline@latest/dist/preline.min.css" rel="stylesheet">\\n<script src="https://cdn.jsdelivr.net/npm/preline@latest/dist/preline.min.js"><\/script>',
                
                'shoelace': '<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@shoelace-style/shoelace@2.0.0-beta.69/dist/themes/light.css">\\n<script type="module" src="https://cdn.jsdelivr.net/npm/@shoelace-style/shoelace@2.0.0-beta.69/dist/shoelace.js"><\/script>',
                
                'uikit': '<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/uikit@3.7.6/dist/css/uikit.min.css">\\n<script src="https://cdn.jsdelivr.net/npm/uikit@3.7.6/dist/js/uikit.min.js"><\/script>\\n<script src="https://cdn.jsdelivr.net/npm/uikit@3.7.6/dist/js/uikit-icons.min.js"><\/script>',
                
                'metro': '<link rel="stylesheet" href="https://cdn.metroui.org.ua/current/metro.min.css">\\n<script src="https://cdn.metroui.org.ua/current/metro.min.js"><\/script>',
                
                'bulma': '<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css">',
                
                'foundation': '<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/foundation-sites@6.7.5/dist/css/foundation.min.css">\\n<script src="https://cdn.jsdelivr.net/npm/foundation-sites@6.7.5/dist/js/foundation.min.js"><\/script>',
                
                'semantic': '<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.css">\\n<script src="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.js"><\/script>',
                
                'materialize': '<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">\\n<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"><\/script>'
            };
            
            return frameworks[framework] || '';
        }

        function getSelectedFramework() {
            const selectedFramework = uiFramework.value;
            if (selectedFramework === 'custom') {
                return cssJsFramework.value.trim();
            }
            return getFrameworkCDN(selectedFramework);
        }
    </script>
</body>
</html>