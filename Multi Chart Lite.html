
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Fast Technical Analysis</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    :root {
      --bg-dark: #0f111a;
      --bg-light: #f8fafc;
      --text-light: #f1f2f6;
      --text-dark: #1e293b;
      --card-dark: #1a1c27;
      --card-light: #ffffff;
      --accent: #3c40c6;
      --accent-light: #4f46e5;
    }

    body {
      margin: 0;
      font-family: 'Inter', sans-serif;
      background-color: var(--bg-dark);
      color: var(--text-light);
      transition: all 0.3s ease;
    }

    body.light {
      background-color: var(--bg-light);
      color: var(--text-dark);
    }

    .chart-tile {
      min-height: 250px;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    .chart-tile:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.2);
    }

    .tradingview-widget-container {
      height: 100%;
    }

    .command-input:focus {
      outline: 2px solid var(--accent);
    }

    .dark-light-toggle {
      transition: all 0.3s ease;
    }

    .dark-light-toggle:hover {
      transform: scale(1.05);
    }

    .saved-commands {
      max-height: 200px;
      overflow-y: auto;
    }

    .saved-commands::-webkit-scrollbar {
      width: 6px;
    }

    .saved-commands::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.1);
    }

    .saved-commands::-webkit-scrollbar-thumb {
      background: var(--accent);
      border-radius: 3px;
    }

    .tooltip {
      position: relative;
    }

    .tooltip-text {
      visibility: hidden;
      width: 120px;
      background-color: #333;
      color: #fff;
      text-align: center;
      border-radius: 6px;
      padding: 5px;
      position: absolute;
      z-index: 1;
      bottom: 125%;
      left: 50%;
      transform: translateX(-50%);
      opacity: 0;
      transition: opacity 0.3s;
    }

    .tooltip:hover .tooltip-text {
      visibility: visible;
      opacity: 1;
    }
  </style>
</head>
<body class="dark">
  <div class="header bg-gray-900/40 border-b border-gray-800 p-3 flex flex-wrap gap-3 items-center justify-between sticky top-0 z-10 backdrop-blur-sm">
    <div class="flex items-center gap-2 flex-1 min-w-[200px]">
      <i class="fas fa-chart-line text-indigo-500"></i>
      <input 
        id="cmdInput" 
        class="command-input bg-gray-800 text-white px-4 py-2 rounded-lg w-full focus:outline-none focus:ring-2 focus:ring-indigo-500" 
        placeholder="e.g., AAPL 1D RSI MACD" 
        autocomplete="off"
      />
    </div>
    
    <div class="flex items-center gap-2">
      <button 
        id="saveBtn" 
        class="bg-emerald-600 hover:bg-emerald-700 text-white px-3 py-2 rounded-lg text-sm flex items-center gap-1 transition-all"
      >
        <i class="fas fa-save"></i>
        <span>Save</span>
      </button>
      
      <button 
        onclick="toggleTheme()" 
        class="dark-light-toggle bg-indigo-600 hover:bg-indigo-700 text-white px-3 py-2 rounded-lg text-sm flex items-center gap-1"
      >
        <i class="fas fa-moon"></i>
        <span>Theme</span>
      </button>
      
      <div class="relative tooltip">
        <button 
          id="helpBtn" 
          class="bg-gray-700 hover:bg-gray-600 text-white px-3 py-2 rounded-lg text-sm flex items-center gap-1"
        >
          <i class="fas fa-question"></i>
        </button>
        <span class="tooltip-text">Help & Examples</span>
      </div>
    </div>
  </div>

  <div class="container mx-auto px-4 py-6">
    <div id="savedCommands" class="mb-6 hidden">
      <h3 class="text-lg font-semibold mb-2 flex items-center gap-2">
        <i class="fas fa-bookmark text-indigo-500"></i>
        Saved Commands
      </h3>
      <div class="saved-commands bg-gray-800/50 rounded-lg p-2 grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-2"></div>
    </div>

    <div id="chartGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"></div>
  </div>

  <!-- Help Modal -->
  <div id="helpModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
    <div class="bg-gray-800 rounded-lg p-6 max-w-2xl w-full max-h-[80vh] overflow-y-auto">
      <div class="flex justify-between items-center mb-4">
        <h3 class="text-xl font-bold">Help & Examples</h3>
        <button onclick="document.getElementById('helpModal').classList.add('hidden')" class="text-gray-400 hover:text-white">
          <i class="fas fa-times"></i>
        </button>
      </div>
      
      <div class="space-y-4">
        <div>
          <h4 class="font-semibold text-indigo-400">Basic Usage</h4>
          <p>Enter a symbol, time interval, and indicators separated by spaces.</p>
          <p class="text-sm text-gray-400 mt-1">Example: <code class="bg-gray-700 px-2 py-1 rounded">AAPL 1D RSI MACD</code></p>
        </div>
        
        <div>
          <h4 class="font-semibold text-indigo-400">Symbol Formats</h4>
          <ul class="list-disc pl-5 space-y-1">
            <li><code>AAPL</code> - Apple Inc.</li>
            <li><code>NASDAQ:AAPL</code> - Exchange prefix</li>
            <li><code>BTCUSD</code> - Cryptocurrencies</li>
          </ul>
        </div>
        
        <div>
          <h4 class="font-semibold text-indigo-400">Time Intervals</h4>
          <div class="grid grid-cols-2 sm:grid-cols-3 gap-2 mt-2">
            <span class="bg-gray-700 px-2 py-1 rounded text-sm">1</span>
            <span class="bg-gray-700 px-2 py-1 rounded text-sm">5</span>
            <span class="bg-gray-700 px-2 py-1 rounded text-sm">15</span>
            <span class="bg-gray-700 px-2 py-1 rounded text-sm">60</span>
            <span class="bg-gray-700 px-2 py-1 rounded text-sm">D</span>
            <span class="bg-gray-700 px-2 py-1 rounded text-sm">W</span>
            <span class="bg-gray-700 px-2 py-1 rounded text-sm">M</span>
          </div>
        </div>
        
        <div>
          <h4 class="font-semibold text-indigo-400">Available Indicators</h4>
          <div class="grid grid-cols-2 sm:grid-cols-3 gap-2 mt-2">
            <span class="bg-gray-700 px-2 py-1 rounded text-sm">RSI</span>
            <span class="bg-gray-700 px-2 py-1 rounded text-sm">MACD</span>
            <span class="bg-gray-700 px-2 py-1 rounded text-sm">BB</span>
            <span class="bg-gray-700 px-2 py-1 rounded text-sm">EMA</span>
            <span class="bg-gray-700 px-2 py-1 rounded text-sm">SMA</span>
            <span class="bg-gray-700 px-2 py-1 rounded text-sm">VWAP</span>
            <span class="bg-gray-700 px-2 py-1 rounded text-sm">Stoch</span>
            <span class="bg-gray-700 px-2 py-1 rounded text-sm">ADX</span>
            <span class="bg-gray-700 px-2 py-1 rounded text-sm">ATR</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    const chartGrid = document.getElementById('chartGrid');
    const input = document.getElementById('cmdInput');
    const saveBtn = document.getElementById('saveBtn');
    const helpBtn = document.getElementById('helpBtn');
    const savedCommandsContainer = document.getElementById('savedCommands');
    const savedCommandsList = document.querySelector('.saved-commands');
    let darkMode = true;
    let savedCommands = JSON.parse(localStorage.getItem('savedCommands')) || [];

    // Initialize saved commands display
    function initSavedCommands() {
      if (savedCommands.length > 0) {
        savedCommandsContainer.classList.remove('hidden');
        renderSavedCommands();
      }
    }

    // Render saved commands
    function renderSavedCommands() {
      savedCommandsList.innerHTML = '';
      savedCommands.forEach((cmd, index) => {
        const cmdEl = document.createElement('div');
        cmdEl.className = 'bg-gray-700/50 hover:bg-gray-700 rounded p-2 flex justify-between items-center cursor-pointer transition-colors';
        cmdEl.innerHTML = `
          <span class="truncate">${cmd}</span>
          <div class="flex gap-1">
            <button onclick="loadSavedCommand(${index})" class="text-indigo-400 hover:text-indigo-300 p-1">
              <i class="fas fa-play"></i>
            </button>
            <button onclick="removeSavedCommand(${index})" class="text-red-400 hover:text-red-300 p-1">
              <i class="fas fa-trash"></i>
            </button>
          </div>
        `;
        savedCommandsList.appendChild(cmdEl);
      });
    }

    // Load saved command
    function loadSavedCommand(index) {
      input.value = savedCommands[index];
      processCommand();
    }

    // Remove saved command
    function removeSavedCommand(index) {
      savedCommands.splice(index, 1);
      localStorage.setItem('savedCommands', JSON.stringify(savedCommands));
      renderSavedCommands();
      if (savedCommands.length === 0) {
        savedCommandsContainer.classList.add('hidden');
      }
    }

    // Save current command
    function saveCurrentCommand() {
      const val = input.value.trim();
      if (!val) return;
      
      if (!savedCommands.includes(val)) {
        savedCommands.push(val);
        localStorage.setItem('savedCommands', JSON.stringify(savedCommands));
        savedCommandsContainer.classList.remove('hidden');
        renderSavedCommands();
        
        // Show notification
        const notification = document.createElement('div');
        notification.className = 'fixed bottom-4 right-4 bg-emerald-600 text-white px-4 py-2 rounded-lg shadow-lg flex items-center gap-2 animate-fade-in';
        notification.innerHTML = `
          <i class="fas fa-check"></i>
          <span>Command saved!</span>
        `;
        document.body.appendChild(notification);
        
        setTimeout(() => {
          notification.classList.add('animate-fade-out');
          setTimeout(() => notification.remove(), 300);
        }, 2000);
      }
    }

    // Toggle theme
    function toggleTheme() {
      darkMode = !darkMode;
      document.body.classList.toggle('light', !darkMode);
      document.body.classList.toggle('dark', darkMode);
      
      // Update all charts
      document.querySelectorAll('.tradingview-widget-container iframe').forEach(iframe => {
        iframe.contentWindow.postMessage({
          event: 'themeChange',
          theme: darkMode ? 'dark' : 'light'
        }, '*');
      });
    }

    // Process command
    function processCommand() {
      const val = input.value.trim();
      if (!val) return;
      
      const parts = val.split(" ");
      const symbol = parts[0] || "NASDAQ:AAPL";
      const interval = parts[1] || "D";
      const studies = parts.slice(2);

      addChart(symbol, interval, studies);
      input.value = "";
    }

    // Add chart
    function addChart(symbol, interval, studies=[]) {
      const container = document.createElement("div");
      container.className = "chart-tile bg-gray-800 rounded-lg shadow-md overflow-hidden relative";
      container.style.minHeight = "450px";

      const header = document.createElement("div");
      header.className = "bg-gray-700/50 px-4 py-2 flex justify-between items-center";
      header.innerHTML = `
        <div class="flex items-center gap-2">
          <i class="fas fa-chart-line text-indigo-400"></i>
          <span class="font-medium">${symbol} â€¢ ${interval}</span>
        </div>
        <div class="flex gap-1">
          <button class="text-gray-300 hover:text-white p-1">
            <i class="fas fa-expand"></i>
          </button>
          <button class="close-btn text-gray-300 hover:text-red-400 p-1">
            <i class="fas fa-times"></i>
          </button>
        </div>
      `;

      const closeBtn = header.querySelector('.close-btn');
      closeBtn.onclick = () => container.remove();

      const chartId = "tv" + Date.now();
      const script = document.createElement("script");
      script.type = "text/javascript";
      script.src = "https://s3.tradingview.com/external-embedding/embed-widget-advanced-chart.js";
      script.async = true;

      const config = {
        "autosize": true,
        "symbol": symbol,
        "interval": interval,
        "timezone": "Etc/UTC",
        "theme": darkMode ? "dark" : "light",
        "style": "1",
        "locale": "en",
        "hide_side_toolbar": true,
        "allow_symbol_change": true,
        "details": true,
        "calendar": false,
        "support_host": "https://www.tradingview.com"
      };

      if (studies.length > 0) {
        config.studies = studies.map(s => "STD;" + s.toUpperCase());
      }

      script.innerHTML = JSON.stringify(config);
      const widgetDiv = document.createElement("div");
      widgetDiv.style = "height:450px;width:100%";
      widgetDiv.className = "tradingview-widget-container__widget";

      const wrapper = document.createElement("div");
      wrapper.className = "tradingview-widget-container";
      wrapper.appendChild(widgetDiv);
      wrapper.appendChild(script);

      container.appendChild(header);
      container.appendChild(wrapper);
      chartGrid.appendChild(container);
      
      // Scroll to the new chart
      container.scrollIntoView({ behavior: 'smooth' });
    }

    // Event listeners
    input.addEventListener('keydown', function(e) {
      if (e.key === 'Enter') {
        processCommand();
      }
    });

    saveBtn.addEventListener('click', saveCurrentCommand);
    helpBtn.addEventListener('click', () => {
      document.getElementById('helpModal').classList.remove('hidden');
    });

    // Initialize
    initSavedCommands();

    // Add some example charts on first load
    if (chartGrid.children.length === 0) {
      addChart("NASDAQ:AAPL", "D", ["RSI", "MACD"]);
      addChart("BTCUSD", "1D", ["BB", "VWAP"]);
    }
  </script>
</body>
</html>